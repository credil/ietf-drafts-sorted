<?xml version="1.0" encoding="US-ASCII"?><?xml-stylesheet type='text/xsl' href='../../rfc2629.xslt'?><?rfc toc="yes"?><?rfc tocdepth="4"?><?rfc symrefs="yes"?><?rfc sortrefs="yes"?><?rfc rfcedstyle="yes"?><?rfc compact="no"?><?rfc subcompact="no"?><!DOCTYPE rfc SYSTEM "rfc2629.dtd" [<!ENTITY rfc2119 PUBLIC "" "bibxml/reference.RFC.2119.xml"><!ENTITY rfc2616 PUBLIC "" "bibxml/reference.RFC.2616.xml"><!ENTITY rfc2617 PUBLIC "" "bibxml/reference.RFC.2617.xml"><!ENTITY rfc2818 PUBLIC "" "bibxml/reference.RFC.2818.xml"><!ENTITY rfc3744 PUBLIC "" "bibxml/reference.RFC.3744.xml"><!ENTITY rfc3864 PUBLIC "" "bibxml/reference.RFC.3864.xml"><!ENTITY rfc4791 PUBLIC "" "bibxml/reference.RFC.4791.xml"><!ENTITY rfc4918 PUBLIC "" "bibxml/reference.RFC.4918.xml"><!ENTITY rfc5234 PUBLIC "" "bibxml/reference.RFC.5234.xml"><!ENTITY rfc5545 PUBLIC "" "bibxml/reference.RFC.5545.xml"><!ENTITY rfc5546 PUBLIC "" "bibxml/reference.RFC.5546.xml"><!ENTITY rfc6047 PUBLIC "" "bibxml/reference.RFC.6047.xml"><!ENTITY rfc6125 PUBLIC "" "bibxml/reference.RFC.6125.xml"><!ENTITY W3C.REC-xml-20081126 PUBLIC "" "bibxml4/reference.W3C.REC-xml-20081126.xml">]><rfc category="std" ipr="pre5378Trust200902" docName="draft-desruisseaux-caldav-sched-12"updates="4791,5546"><front>  <title abbrev="CalDAV Scheduling Extensions">CalDAV Scheduling Extensions to WebDAV</title>  <author initials="C." surname="Daboo" fullname="Cyrus Daboo">    <organization abbrev="Apple Inc.">Apple Inc.</organization>    <address>      <postal>        <street>1 Infinite Loop</street>        <city>Cupertino</city>        <region>CA</region>        <code>95014</code>        <country>USA</country>      </postal>      <email>cyrus@daboo.name</email>      <uri>http://www.apple.com/</uri>    </address>  </author>  <author initials="B." surname="Desruisseaux" fullname="Bernard Desruisseaux">    <organization abbrev="Oracle">Oracle Corporation</organization>    <address>      <postal>        <street>600 Blvd. de Maisonneuve West</street>        <street>Suite 1900</street>        <city>Montreal</city>        <region>QC</region>        <code>H3A 3J2</code>        <country>CANADA</country>      </postal>      <email>bernard.desruisseaux@oracle.com</email>      <uri>http://www.oracle.com/</uri>    </address>  </author>  <date/>  <area>Applications</area>  <keyword>calsify</keyword>  <keyword>calsched</keyword>  <keyword>calsch</keyword>  <keyword>caldav</keyword>  <keyword>calendar</keyword>  <keyword>calendaring</keyword>  <keyword>scheduling</keyword>  <keyword>webcal</keyword>  <keyword>webdav</keyword>  <keyword>ical</keyword>  <keyword>icalendar</keyword>  <keyword>ischedule</keyword>  <keyword>itip</keyword>  <keyword>imip</keyword>  <keyword>text/calendar</keyword>  <keyword>http</keyword>  <abstract>    <t>      This document defines extensions to the CalDAV "calendar-access"      feature to specify a standard way of performing scheduling      operations with iCalendar-based calendar components. This      document defines the "calendar-auto-schedule" feature of      CalDAV.    </t>  </abstract></front><middle>  <section title="Introduction">    <t>      This document specifies extensions to the      <xref target="RFC4791">CalDAV "calendar-access"</xref>      feature to enable scheduling of      <xref target="RFC5545">iCalendar-based</xref>      calendar components between calendar users.</t>    <t>This extension      leverages the scheduling methods defined in the iCalendar      Transport-independent Interoperability Protocol <xref      target="RFC5546">(iTIP)</xref> to permit calendar      users to perform scheduling operations such as schedule,      reschedule, respond to scheduling request or cancel      calendar components, as well as search for busy time information.      However, the following <xref target="RFC5546">iTIP</xref>        features are not covered: publishing, countering, delegating,        refreshing and forwarding calendar components, as well as replacing        the Organizer of a calendar component. It is expected that future        extensions will be developed to address these.      </t>    <t>      This specification defines a client/server scheduling protocol, where the server is made responsible for sending scheduling messages and processing incoming scheduling messages. The client operations of creating, modifying or deleting a calendar component in a calendar is enough to trigger the server to deliver the necessary scheduling messages to the appropriate calendar users. This approach is sometimes referred to as "implicit scheduling".    </t>      <t>        This specification only addresses how scheduling occurs with users on a single system (i.e., scheduling between CalDAV servers, or some other calendaring and scheduling system, is not defined). However, this specification is compatible with servers being able to send or receive scheduling messages with "external" users (e.g., using the <xref target="RFC6047">iCalendar Message-Based Interoperability Protocol iMIP</xref>).      </t>    <t>    	<xref target="scheduling_txn"/> defines the automated "Scheduling Operations", that allow a client to store iCalendar data on a CalDAV server, with the server taking specific actions in response. One of three scheduling operations can take place: "create", "modify" or "remove", based on the HTTP method used for the request, and a comparison between any existing and any new iCalendar data.    </t>    <t>    	<xref target='automatic-processing'/> defines how the server processes scheduling messages sent as the result of a scheduling operation.    </t>    <t>    	<xref target="freebusy"/> defines how freebusy requests with an immediate response are accomplished.    </t>    <t>    	<xref target="scheduling_acl"/> defines access control privileges for the scheduling operations defined in this specification.    </t>    <t>      For the majority of the following discussion, scheduling of events will be      discussed. However, scheduling of to-dos is      also fully supported by this specification.    </t>    <t>      Discussion of this Internet-Draft is taking place on the mailing      lists at &lt;https://www.ietf.org/mailman/listinfo/caldav&gt; and &lt;http://lists.osafoundation.org/pipermail/ietf-caldav&gt;.    </t>    <section title="Terminology">      <t>        This specification reuses much of the same terminology as        <xref target="RFC5545">iCalendar</xref>,        <xref target="RFC5546">iTIP</xref>,        <xref target="RFC4918">WebDAV</xref>, and        <xref target="RFC4791">CalDAV</xref>.        Additional terms used by this specification are:      </t>      <t>        <list style="hanging">          <t hangText="Scheduling object resource:">            A calendar object resource contained in a calendar            collection for which the server will take care of sending            scheduling messages on behalf of the owner of the calendar            collection.          </t>          <t hangText="Organizer scheduling object resource:">            A scheduling object resource owned by the Organizer.          </t>          <t hangText="Attendee scheduling object resource:">            A scheduling object resource owned by an Attendee.          </t>          <t hangText="Scheduling operation:">            Add, change or remove operations on a scheduling object            resource for which the server will deliver scheduling            messages to other calendar users.          </t>          <t hangText="Scheduling message:">            A calendar object that describes a scheduling            operation such as schedule, reschedule, reply, or            cancel.          </t>          <t hangText="Scheduling Outbox collection:">            A resource at which busy time information requests are            targeted.          </t>          <t hangText="Scheduling Inbox collection:">            A collection in which incoming scheduling messages are            delivered.          </t>        </list>      </t>    </section>    <section title="Notational Conventions">      <t>        The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL"        in this document are to be interpreted as described in <xref        target="RFC2119"/>.      </t>      <t>        The Augmented BNF (ABNF) syntax used by this document to specify        the format definition of new iCalendar elements is defined in        <xref target="RFC5234"/>.      </t>      <t>        The Augmented BNF (ABNF) syntax used by this document to specify        the format definition of new message header fields to be used        with the HTTP/1.1 protocol is described in Section 2.1 of        <xref target="RFC2616"/>. Since this Augmented BNF uses the        basic production rules provided in Section 2.2 of        <xref target="RFC2616"/>, these rules apply to this document        as well.      </t>      <t>        The term "protected" is used in the Conformance field of WebDAV    property definitions as defined in Section 15 of    <xref target="RFC4918"/>.      </t>    </section>    <section title="XML Namespaces and Processing">          <t>            This document uses XML DTD fragments (<xref target="W3C.REC-xml-20081126"/>, Section 3.2) as a purely notational convention.  WebDAV request and response bodies cannot be validated by a DTD due to the specific extensibility rules defined in Section 17 of [RFC4918] and due to the fact that all XML elements defined by that specification use the XML namespace name "DAV:".  In particular:            <list style='numbers'>                <t>element names use the "DAV:" namespace,</t>                <t>element ordering is irrelevant unless explicitly stated,</t>                <t>extension elements (elements not already defined as valid child elements) can be added anywhere, except when explicitly stated otherwise,</t>                <t>extension attributes (attributes not already defined as valid for this element) can be added anywhere, except when explicitly stated otherwise.</t>            </list>          </t>          <t>            The XML elements specified in this document are defined in the            "urn:ietf:params:xml:ns:caldav" XML namespace registered by            <xref target="RFC4791">CalDAV</xref>.          </t>          <t>            When XML element types in the namespaces "DAV:" and "urn:ietf:params:xml:ns:caldav" are referenced in this document outside of the context of an XML fragment, the strings "DAV:" and "CALDAV:" will be prefixed to the element types, respectively.          </t>          <t>            This document inherits, and sometimes extends, DTD productions from Section 14 of <xref target="RFC4918"/>.          </t>        <t>            Also note that some CalDAV XML element names are identical to WebDAV XML element names, though their namespace differs. Care needs to be taken not to confuse the two sets of names.        </t>    </section>  </section>  <section title="Scheduling Support" anchor="scheduling_support">    <t>A server that supports the features described in this document is REQUIRED 	to support the <xref target="RFC4791">CalDAV "calendar-access"</xref> feature. Servers include "calendar-auto-schedule" as a field in the DAV response header from an OPTIONS request on any resource that supports any scheduling operations, properties, privileges or methods.    </t>    <t>      This specification introduces new collection resource types      that are used to manage scheduling object resources, and scheduling      privileges (as per <xref target="scheduling_acl"/>), as well as provide scheduling functionality. It is the server's responsibility to create these collection resources, and clients have no way to create or delete them.    </t>    <section anchor="schedule-outbox" title="Scheduling Outbox Collection">      <t>        A scheduling Outbox collection is used as the target for         busy time information requests, and to manage privileges that apply to outgoing scheduling requests.      </t>      <t>        A scheduling Outbox collection MUST report the DAV:collection        and CALDAV:schedule-outbox XML elements in the value of the        DAV:resourcetype property. The element type declaration for        CALDAV:schedule-outbox is:        <figure><artwork><![CDATA[  <!ELEMENT schedule-outbox EMPTY>]]></artwork></figure>      </t>      <t>        Example:         <figure><artwork><![CDATA[  <D:resourcetype xmlns:D="DAV:">    <D:collection/>    <C:schedule-outbox xmlns:C="urn:ietf:params:xml:ns:caldav"/>  </D:resourcetype>]]></artwork></figure>      </t>      <t>        A scheduling Outbox collection MUST NOT be a child (at any depth)        of a calendar collection resource.      </t>      <t>        The following WebDAV properties specified in CalDAV "calendar-access"        <xref target="RFC4791"/> MAY also be defined on scheduling Outbox collections and apply to scheduling messages submitted to the scheduling Outbox collection with the POST method:        <list style='symbols'>          <t>            CALDAV:supported-calendar-component-set          </t>          <t>            CALDAV:supported-calendar-data          </t>          <t>            CALDAV:max-resource-size          </t>          <t>            CALDAV:min-date-time          </t>          <t>            CALDAV:max-date-time          </t>          <t>            CALDAV:max-attendees-per-instance          </t>        </list>      </t>      <t>        The use of child resources in a scheduling Outbox collection is reserved for future revisions or extensions of this specification.      </t>      <t>The following WebDAV property is defined on principal resources and used to locate the corresponding Outbox collection for the associated principal.</t>        <section title="CALDAV:schedule-outbox-URL Property">          <t>            <list style="hanging">              <t hangText="Name:">schedule-outbox-URL</t>              <t hangText="Namespace:">urn:ietf:params:xml:ns:caldav</t>              <t hangText="Purpose:">Identify the URL of the scheduling Outbox collection owned by the associated principal resource.</t>              <t hangText="Protected:">This property MAY be protected.</t>              <t hangText="PROPFIND behavior:">This property SHOULD NOT be returned by a PROPFIND allprop request (as defined in Section 14.2 of <xref target="RFC4918"/>).</t>              <t hangText="COPY/MOVE behavior:">This property value SHOULD be preserved in COPY and MOVE operations.</t>              <t hangText="Description:">This property is needed for a client to determine where the scheduling Outbox collection of the current user is located so that sending of scheduling messages can occur. If not present, then the associated calendar user is not enabled for the sending of scheduling messages on the server.</t>              <t hangText="Definition:">                <figure><artwork><![CDATA[  <!ELEMENT schedule-outbox-URL (DAV:href)>]]></artwork></figure>              </t>            </list>          </t>        </section>    </section>    <section anchor="schedule-inbox" title="Scheduling Inbox Collection">      <t>        A scheduling Inbox collection contains copies of incoming        scheduling messages. These can be requests sent by an        Organizer, or replies sent by an Attendee in response to        a request. The scheduling Inbox collection is also used to manage scheduling privileges.      </t>      <t>        A scheduling Inbox collection MUST report the DAV:collection        and CALDAV:schedule-inbox XML elements in the value of the        DAV:resourcetype property. The element type declaration for        CALDAV:schedule-inbox is:        <figure><artwork><![CDATA[  <!ELEMENT schedule-inbox EMPTY>]]></artwork></figure>      </t>      <t>        Example:       <figure><artwork><![CDATA[  <D:resourcetype xmlns:D="DAV:">    <D:collection/>    <C:schedule-inbox xmlns:C="urn:ietf:params:xml:ns:caldav"/>  </D:resourcetype>]]></artwork></figure></t>      <t>        Scheduling Inbox collections MUST only contain calendar object        resources that obey the restrictions specified in <xref        target="RFC5546">iTIP</xref>. Consequently,        scheduling Inbox collections MUST NOT contain any types of        collection resources. Restrictions defined in Section 4.1 of        <xref target="RFC4791">CalDAV "calendar-access"</xref> on calendar        object resources contained in calendar collections (e.g., "UID"        uniqueness) do not apply to calendar object resources contained in        a scheduling Inbox collection. Thus, multiple calendar object resources        contained in a scheduling Inbox collection can have the same "UID"        property value (i.e., multiple scheduling messages for the same        calendar component).      </t>      <t>        A scheduling Inbox collection MUST NOT be a child (at any depth)        of a calendar collection resource.      </t>      <t>        The following WebDAV properties specified in         <xref target="RFC4791">CalDAV "calendar-access"</xref> MAY        also be defined on scheduling Inbox collections and apply to scheduling        messages delivered to the collection:        <list style='symbols'>          <t>            CALDAV:supported-calendar-component-set          </t>          <t>            CALDAV:supported-calendar-data          </t>          <t>            CALDAV:max-resource-size          </t>          <t>            CALDAV:min-date-time          </t>          <t>            CALDAV:max-date-time          </t>          <t>            CALDAV:max-instances          </t>          <t>            CALDAV:max-attendees-per-instance          </t>          <t>            CALDAV:calendar-timezone          </t>        </list>      </t>      <t>The following WebDAV property is defined on principal resources and used to locate the corresponding Inbox collection for the associated principal.</t>        <section title="CALDAV:schedule-inbox-URL Property">          <t>            <list style="hanging">              <t hangText="Name:">schedule-inbox-URL</t>              <t hangText="Namespace:">urn:ietf:params:xml:ns:caldav</t>              <t hangText="Purpose:">Identify the URL of the scheduling Inbox collection owned by the associated principal resource.</t>              <t hangText="Protected:">This property MAY be protected.</t>              <t hangText="PROPFIND behavior:">This property SHOULD NOT be returned by a PROPFIND allprop request (as defined in Section 14.2 of <xref target="RFC4918"/>).</t>              <t hangText="COPY/MOVE behavior:">This property value SHOULD be preserved in COPY and MOVE operations.</t>              <t hangText="Description:">This property allows a client to determine where the scheduling Inbox collection of the current user is located so that processing of scheduling messages can occur. If not present, then the associated calendar user is not enabled for reception of scheduling messages on the server.</t>              <t hangText="Definition:">                <figure><artwork><![CDATA[  <!ELEMENT schedule-inbox-URL (DAV:href)>]]></artwork></figure>              </t>            </list>          </t>        </section>    </section>    <section anchor="reports" title="Calendaring Reports Extensions">      <t>        This specification extends the CALDAV:calendar-query and        CALDAV:calendar-multiget REPORTs to return results for calendar        object resources in scheduling Inbox collections.      </t>      <t>        When a CALDAV:calendar-query REPORT includes a time-range query        and targets a scheduling Inbox collection, if any calendar        object resources contain "VEVENT" calendar components that do        not include a "DTSTART" iCalendar property (as allowed by <xref        target="RFC5546">iTIP</xref>) then such components        MUST always match the time-range query test.      </t>      <t>        Note that the CALDAV:free-busy-query REPORT is not supported on        scheduling Inbox collections.      </t>    </section>      <section anchor="principal.properties" title="Additional Principal Properties">        <t>This section defines new properties for WebDAV principal resources as defined in <xref target="RFC3744"/>. These properties are likely to be protected but the server MAY allow them to be written by appropriate users.</t>        <section title="CALDAV:calendar-user-address-set Property">          <t>            <list style="hanging">              <t hangText="Name:">calendar-user-address-set</t>              <t hangText="Namespace:">urn:ietf:params:xml:ns:caldav</t>              <t hangText="Purpose:">Identify the calendar addresses of the associated principal resource.</t>              <t hangText="Protected:">This property MAY be protected.</t>              <t hangText="PROPFIND behavior:">This property SHOULD NOT be returned by a PROPFIND allprop request (as defined in Section 14.2 of <xref target="RFC4918"/>).</t>              <t hangText="COPY/MOVE behavior:">This property value SHOULD be preserved in COPY and MOVE operations.</t>              <t hangText="Description:">Support for this property is REQUIRED. This property is needed to map calendar user addresses in iCalendar data to principal resources and their associated scheduling Inbox and Outbox collections. In the event that a user has no well defined identifier for their calendar user address, the URI of their principal resource can be used. This property SHOULD be searchable using the DAV:principal-property-search REPORT. The DAV:principal-search-property-set REPORT SHOULD identify this property as such. If not present, then the associated calendar user is not enabled for scheduling on the server.</t>              <t hangText="Definition:">                <figure><artwork><![CDATA[  <!ELEMENT calendar-user-address-set (DAV:href*)>]]></artwork></figure>              </t>              <t hangText="Example:">                <figure><artwork><![CDATA[  <C:calendar-user-address-set xmlns:D="DAV:"      xmlns:C="urn:ietf:params:xml:ns:caldav">    <D:href>mailto:bernard@example.com</D:href>    <D:href>mailto:bernard.desruisseaux@example.com</D:href>  </C:calendar-user-address-set>]]></artwork></figure>              </t>            </list>          </t>        </section>        <section title="CALDAV:calendar-user-type Property">          <t>            <list style="hanging">              <t hangText="Name:">calendar-user-type</t>              <t hangText="Namespace:">urn:ietf:params:xml:ns:caldav</t>              <t hangText="Purpose:">Identifies the calendar user type of the associated principal resource.</t>              <t hangText="Value:">Same values allowed for the iCalendar "CUTYPE" property parameter defined in Section 3.2.3 of <xref target="RFC5545"/>.</t>              <t hangText="Protected:">This property MAY be protected.</t>              <t hangText="PROPFIND behavior:">This property SHOULD NOT be returned by a PROPFIND allprop request (as defined in Section 14.2 of <xref target="RFC4918"/>).</t>              <t hangText="COPY/MOVE behavior:">This property value SHOULD be preserved in COPY and MOVE operations.</t>              <t hangText="Description:">Clients can query principal resources in order to lookup attendees available on the server. When doing this, it is useful to know, or restrict the query to, certain types of calendar user (e.g., only search for "people", or only search for "rooms"). This property MAY be defined on principal resources to indicate the type of calendar user associated with the principal resource. Its value is the same as the iCalendar "CUTYPE" property parameter that can be used on "ATTENDEE" properties. This property SHOULD be searchable using the DAV:principal-property-search REPORT. The DAV:principal-search-property-set REPORT SHOULD identify this property as such.</t>              <t hangText="Definition:">                <figure><artwork><![CDATA[  <!ELEMENT calendar-user-type (#PCDATA)>]]></artwork></figure>              </t>              <t hangText="Example:">                <figure><artwork><![CDATA[  <C:calendar-user-type      xmlns:C="urn:ietf:params:xml:ns:caldav">INDIVIDUAL<  /C:calendar-user-type>]]></artwork></figure>              </t>            </list>          </t>      </section>    </section>  </section>  <section title="Scheduling Operations" anchor="scheduling_txn">    <t>      When a calendar object resource is created, modified or removed      from a calendar collection, the server examines the calendar data and      checks to see whether the data represents a scheduling object      resource. If it does, the server will automatically attempt to      deliver a scheduling message to the appropriate calendar users.      Several types of scheduling operations can occur in this case,      equivalent to iTIP "REQUEST", "REPLY", "CANCEL", and "ADD"      operations.    </t>    <section title="Identifying Scheduling Object Resources" anchor="id_scheduling">      <t>        Calendar object resources on which the server performs        scheduling operations are referred to as scheduling object        resources.  There are two types of scheduling object resources:        organizer scheduling object resources, and attendee scheduling        object resources.      </t>      <t>        A calendar object resource is considered to be a valid        organizer scheduling object resource if the "ORGANIZER"        iCalendar property is present and set in all the calendar        components to a value that matches one of the calendar user        addresses of the owner of the calendar collection.      </t>      <t>        A calendar object resource is considered to be a valid attendee        scheduling object resource if the "ORGANIZER" iCalendar        property is present and set in all the calendar components        to the same value and doesn't match one of the calendar user        addresses of the owner of the calendar collection, and        at least one of the "ATTENDEE" iCalendar property values        matches one of the calendar user addresses of the owner of the        calendar collection.      </t>      <t>        The creation of attendee scheduling object resources is        typically done by the server, with the resource being        created in an appropriate calendar collection (see <xref target='default-calendar'/>).      </t>    </section>    <section title="Handling Scheduling Object Resources">      <t>        The server's behavior when processing a scheduling object        resource depends on whether it is owned by the Organizer or        an Attendee specified in the calendar data.      </t>      <section title="Organizer Scheduling Object Resources" anchor="organizer-scheduling">        <t>An Organizer can create, modify or remove a scheduling object resource, subject to access privileges, pre-conditions, and the restrictions defined in Section 4.1 of <xref target="RFC4791"/>. These operations are each described next, and how they are invoked via HTTP requests is described in <xref target="http_methods"/>.        </t>        <t>      The Organizer of a calendar component can also be an Attendee of      that calendar component. In such cases the server MUST NOT send a      scheduling message to the Attendee that matches the Organizer.        </t>		<t>		  The server SHOULD reject any attempt to set the		  "PARTSTAT" iCalendar property parameter value of		  the "ATTENDEE" iCalendar property of other users in		  the calendar object resource to a value other than		  "NEEDS-ACTION" if the "SCHEDULE-AGENT" property		  parameter value is not present or set to the value		  "SERVER".		</t>		<t>		  The server MAY reject attempts to create a scheduling		  object resource that specifies a "UID" property value		  already specified in a scheduling object resource		  contained in another calendar collection of the		  Organizer.		</t>          <section title="Create">            <t>When an Organizer creates a scheduling object resource, the server MUST inspect each "ATTENDEE" property to determine whether to send a scheduling message. The table below indicates the appropriate iTIP method used by the server, taking into account any "SCHEDULE-AGENT" property parameter (see <xref target='schedule-agent'/>) specified on each "ATTENDEE" property.            </t>            <texttable>            <ttcol>SCHEDULE-AGENT</ttcol>            <ttcol>iTIP METHOD</ttcol>            <c>SERVER (default)</c>            <c>REQUEST</c>            <c>CLIENT</c>            <c>--</c>            <c>NONE</c>            <c>--</c>            </texttable>            <t>"SCHEDULE-STATUS" iCalendar property parameters are added or changed on "ATTENDEE" iCalendar properties in the scheduling object resource being created as described in <xref target='schedule-status'/>, with the value set as described in <xref target="schedule-status-value"/>. This will result in the created calendar object resource differing from the calendar data sent in the HTTP request. As a result clients MAY reload the calendar data from the server in order to update to the new server generated state information.            </t>            <t>              The server MUST add a              "SCHEDULE-STATUS" iCalendar property parameter (see <xref target='schedule-status'/>) to the              "ATTENDEE" iCalendar property in the scheduling object              resource being created, and set its value as described in              <xref target="schedule-status-value"/>. This will result              in the created calendar object resource differing from              the calendar data sent in the HTTP request. As a result              clients MAY reload the calendar data from the server              in order to              update to the new server generated state information.              Servers MUST NOT set the "SCHEDULE-STATUS" property              parameter on the "ATTENDEE" property of Attendees              for which it did not attempt to deliver a scheduling              message.            </t>                <t>The server MUST return an error with the CALDAV:allowed-organizer-scheduling-object-change precondition code (<xref target='allowed-organizer-scheduling-object-change'/>) when the Organizer attempts to change the iCalendar data in a manner that is forbidden.</t>          </section>          <section title="Modify">            <t>When an Organizer modifies a scheduling object resource, the server MUST inspect each "ATTENDEE" property in both the original and modified iCalendar data on a per-instance basis to determine whether to send a scheduling message. The table below indicates the appropriate iTIP method used by the server, taking into account any "SCHEDULE-AGENT" property parameter (see <xref target='schedule-agent'/>) specified on each "ATTENDEE" property. The values "SERVER", "CLIENT", and "NONE" in the top and left titles of the table refer to the "SCHEDULE-AGENT" parameter value of the "ATTENDEE" property, and the values "&lt;Absent&gt;" and "&lt;Removed&gt;" are used to cover the cases where the "ATTENDEE" property is not present (Original) or is being removed (Modified).            </t>            <figure><artwork><![CDATA[+---------------+-----------------------------------------------+|               |                   Modified                    ||               +-----------+-----------+-----------+-----------+|               | <Removed> | SERVER    | CLIENT    | NONE      ||               |           | (default) |           |           |+===+===========+===========+===========+===========+===========+|   | <Absent>  |  --       | REQUEST / | --        | --        || O |           |           | ADD       |           |           || r +-----------+-----------+-----------+-----------+-----------+| i | SERVER    |  CANCEL   | REQUEST   | CANCEL    | CANCEL    || g | (default) |           |           |           |           || i +-----------+-----------+-----------+-----------+-----------+| n | CLIENT    |  --       | REQUEST / | --        | --        || a |           |           | ADD       |           |           || l +-----------+-----------+-----------+-----------+-----------+|   | NONE      |  --       | REQUEST / | --        | --        ||   |           |           | ADD       |           |           |+---+-----------+-----------+-----------+-----------+-----------+ ]]></artwork></figure>            <t>"SCHEDULE-STATUS" iCalendar property parameters are added or changed on "ATTENDEE" iCalendar properties in the scheduling object resource being modified as described in <xref target='schedule-status'/>, with the value set as described in <xref target="schedule-status-value"/>. This will result in the created calendar object resource differing from the calendar data sent in the HTTP request. As a result clients MAY reload the calendar data from the server in order to update to the new server generated state information.</t>                <t>The server MUST return an error with the CALDAV:allowed-organizer-scheduling-object-change precondition code (<xref target='allowed-organizer-scheduling-object-change'/>) when the Organizer attempts to change the iCalendar data in a manner that is forbidden.</t>          </section>          <section title="Remove">            <t>            When an Organizer removes a scheduling object resource, the server MUST inspect each "ATTENDEE" property to determine whether to send a scheduling message. The table below indicates the appropriate iTIP method used by the server, taking into account any "SCHEDULE-AGENT" property parameter (see <xref target='schedule-agent'/>) specified on each "ATTENDEE" property.</t>            <texttable>            <ttcol>SCHEDULE-AGENT</ttcol>            <ttcol>iTIP METHOD</ttcol>            <c>SERVER (default)</c>            <c>CANCEL</c>            <c>CLIENT</c>            <c>--</c>            <c>NONE</c>            <c>--</c>            </texttable>          </section>      </section>      <section title="Attendee Scheduling Object Resources" anchor="attendee_scheduling">        <t>An Attendee can create, modify or remove a scheduling object resource. These operations are each described next, and how they are invoked via HTTP requests is described in <xref target="http_methods"/>.</t>          <section title="Allowed Attendee Changes"                   anchor="Allowed-Attendee-Changes">            <t>              Attendees are allowed to make some changes to a scheduling              object resource, though key properties such as start time,              end time, location, and summary are typically under the              control of the Organizer.            </t>            <t>Servers MUST allow Attendees to make the following iCalendar data changes, subject to other restrictions, such as access privileges and pre-conditions:              <list style="numbers">                <t>change their own "PARTSTAT" iCalendar property parameter value.</t>                <t>add, modify or remove any "TRANSP" iCalendar properties.</t>                <t>add, modify or remove any "PERCENT-COMPLETE" iCalendar properties.</t>                <t>add, modify or remove any "COMPLETED" iCalendar properties.</t>                <t>add, modify or remove any "VALARM" iCalendar components.</t>                <t>add, modify or remove the "CALSCALE" iCalendar property within the top-level "VCALENDAR" component.</t>                <t>modify the "PRODID" iCalendar property within the top-level "VCALENDAR" component.</t>                <t>add "EXDATE" iCalendar properties and possibly remove components for overridden recurrence instances.</t>                <t>add, modify or remove any "CREATED", "DTSTAMP" and "LAST-MODIFIED" iCalendar properties.</t>                <t>add, modify or remove "SCHEDULE-STATUS" iCalendar property parameters on "ATTENDEE" properties that have a "SCHEDULE-AGENT" parameter set to "CLIENT".</t>                <t>add new components to represent overridden recurrence instances, provided the only changes to the recurrence instance follow the rules above.</t>              </list>            </t>            <t>The server MUST return an error with the CALDAV:allowed-attendee-scheduling-object-change precondition code (<xref target='allowed-attendee-scheduling-object-change'/>) when the Attendee attempts to change the iCalendar data in a manner forbidden by the server.</t>          </section>          <section title="Create">            <t>Typically an Attendee does not create scheduling object resources, as scheduling messages delivered to them on the server are automatically processed by the server and placed on one of their calendars (see <xref target='automatic-processing'/>). However, in some cases a scheduling message can get delivered directly to the client (e.g., via email <xref target="RFC6047"/>), and the Attendee might wish to store that on the server. In that case the client creates a scheduling object resource in a calendar belonging to the Attendee. It can then set the "SCHEDULE-AGENT" iCalendar property parameter on all "ORGANIZER" iCalendar properties in the resource to determine how the server treats the resource. The value of the "SCHEDULE-AGENT" iCalendar property parameter on all "ORGANIZER" iCalendar properties MUST be the same.</t>            <texttable>            <ttcol>SCHEDULE-AGENT</ttcol>            <ttcol>Action</ttcol>            <c>SERVER (default)</c>            <c>The server will attempt to process changes to the resource using the normal rules for attendee scheduling object resources.</c>            <c>CLIENT</c>            <c>The server does no special processing of the resource. The client is assumed to be handling Attendee replies etc.</c>            <c>NONE</c>            <c>The server does no special processing of the resource.</c>            </texttable>                        <t>"SCHEDULE-STATUS" iCalendar property parameters are added or changed on "ORGANIZER" iCalendar properties in the scheduling object resource being created as described in <xref target='schedule-status'/>, with the value set as described in <xref target="schedule-status-value"/>.</t>          </section>          <section title="Modify">            <t>When a scheduling object resource is modified by an Attendee, the server behavior depends on the value of the "SCHEDULE-AGENT" iCalendar property parameter on the "ORGANIZER" iCalendar properties:</t>            <texttable>            <ttcol>SCHEDULE-AGENT</ttcol>            <ttcol>Action</ttcol>            <c>SERVER (default)</c>            <c>The server will attempt to process the update using the behavior listed below.</c>            <c>CLIENT</c>            <c>The server does no special processing of the resource. The client is assumed to be handling any Attendee replies etc.</c>            <c>NONE</c>            <c>The server does no special processing of the resource.</c>            </texttable>            <t>The server will inspect the changes by comparing the new scheduling object resource with the existing scheduling object resource.</t>            <t>If the Attendee changes one or more "PARTSTAT" iCalendar property values on any component, or adds an overridden component with a changed "PARTSTAT" property, then the server MUST deliver an iTIP "REPLY" scheduling message to the Organizer to indicate the new participation status of the Attendee.</t>            <t>If the Attendee adds an "EXDATE" property value to effectively remove a recurrence instance, the server MUST deliver an iTIP "REPLY" scheduling message to the Organizer to indicate that the Attendee has declined the instance.</t>            <t>"SCHEDULE-STATUS" iCalendar property parameters are added or changed on "ORGANIZER" iCalendar properties in the scheduling object resource being modified as described in <xref target='schedule-status'/>, with the value set as described in <xref target="schedule-status-value"/>. This will result in the updated calendar object resource differing from the calendar data sent in the HTTP request. As a result clients MAY reload the calendar data from the server in order to update to the new server generated state information.</t>          </section>          <section title="Remove" anchor="attendee_remove">            <t>When a scheduling object resource is removed by an Attendee, the server behavior depends on the value of the "SCHEDULE-AGENT" iCalendar property parameter on the "ORGANIZER" iCalendar properties:</t>            <texttable>            <ttcol>SCHEDULE-AGENT</ttcol>            <ttcol>Action</ttcol>            <c>SERVER (default)</c>            <c>The server will attempt to process the removal taking into account any "Schedule-Reply" request header as per <xref target="schedule-reply-header"/>.</c>            <c>CLIENT</c>            <c>The server does no special processing of the resource. The client is assumed to be handling any Attendee replies etc.</c>            <c>NONE</c>            <c>The server does no special processing of the resource.</c>            </texttable>          </section>      </section>      <section anchor="http_methods" title="HTTP Methods">        <t>This section describes how use of various <xref target="RFC2616">HTTP</xref> and <xref target="RFC4918">WebDAV</xref> methods on a scheduling object resource will cause a create, modify or remove operation on that resource as described above. The use of these methods is subject to the restrictions in <xref target='RFC4791'/>, in addition to what is described below.</t>        <section title="PUT" anchor="method_PUT">          <t>When the server receives a PUT method request it MUST execute the following operations, provided all appropriate preconditions are met:</t>          <texttable>            <ttcol>Existing Destination Resource</ttcol>            <ttcol>Resulting Destination Resource</ttcol>            <ttcol>Server Operation</ttcol>            <c>None</c>            <c>Calendar object resource</c>            <c>None</c>            <c>None</c>            <c>Scheduling object resource</c>            <c>Create</c>            <c>Calendar object resource</c>            <c>Calendar object resource</c>            <c>None</c>            <c>Calendar object resource</c>            <c>Scheduling object resource</c>            <c>Create</c>            <c>Scheduling object resource</c>            <c>Calendar object resource</c>            <c>Remove</c>            <c>Scheduling object resource</c>            <c>Scheduling object resource</c>            <c>Modify</c>          </texttable>        </section>        <section title="DELETE" anchor="method_DELETE">          <t>When the server receives a DELETE method request targeted at a scheduling object resource it MUST execute the Remove operation.          </t>          <t>When the server receives a DELETE method request targeted at a calendar collection it MUST execute the Remove operation on all scheduling object resources contained in the calendar collection.          </t>        </section>        <section title="COPY">          <t>When the server receives a COPY method request it MUST execute the following operations based on the source and destination collections in the request:</t>          <texttable>            <ttcol>Source Collection</ttcol>            <ttcol>Destination Collection</ttcol>            <ttcol>Server Operation</ttcol>            <c>Non-calendar collection</c>            <c>Non-calendar collection</c>            <c>None</c>            <c>Non-calendar collection</c>            <c>Calendar collection</c>            <c>(1)</c>            <c>Calendar collection</c>            <c>Non-calendar collection</c>            <c>None</c>            <c>Calendar collection</c>            <c>Calendar collection</c>            <c>(2)</c>          </texttable>          <t>Note 1. The rules in <xref target="method_PUT"/> are applied for the destination of the COPY request.</t>          <t>Note 2. The server MAY reject this as per <xref target='unique-scheduling-object-resource'/>, otherwise None.</t>          <t>The behavior of a COPY method request on a calendar collection is undefined.</t>        </section>        <section title="MOVE">          <t>            When the server receives a MOVE method request it MUST            execute the following operations based on the source and            destination collections in the request:          </t>          <texttable>            <ttcol>Source Collection</ttcol>            <ttcol>Destination Collection</ttcol>            <ttcol>Server Operation</ttcol>            <c>Non-calendar collection</c>            <c>Non-calendar collection</c>            <c>None</c>            <c>Non-calendar collection</c>            <c>Calendar collection</c>            <c>(1)</c>            <c>Calendar collection</c>            <c>Non-calendar collection</c>            <c>(2)</c>            <c>Calendar collection</c>            <c>Calendar collection</c>            <c>None</c>          </texttable>          <t>Note 1. The rules in <xref target="method_PUT"/> are applied for the destination of the MOVE request.</t>          <t>Note 2. The rules in <xref target="method_DELETE"/> are applied for the source of the MOVE request.</t>          <t>The behavior of a MOVE method request on a calendar collection is undefined.</t>        </section>      </section>      <section title="Additional Method Preconditions">        <t>          This specification defines method preconditions          (see Section 16 of <xref target="RFC4918">WebDAV</xref>), in addition to the ones in <xref target="RFC4791"/>,          to provide machine-parseable information in error responses.        </t>        <section title="CALDAV:unique-scheduling-object-resource Precondition" anchor="unique-scheduling-object-resource">          <t>            <list style="hanging">              <t hangText="Name:">unique-scheduling-object-resource</t>              <t hangText="Namespace:">urn:ietf:params:xml:ns:caldav</t>              <t hangText="Apply to:">PUT, COPY, and MOVE</t>              <t hangText="Use with:">403 Forbidden</t>              <t hangText="Purpose:">                (precondition) --                Servers MAY reject requests to create a scheduling                object resource with an iCalendar "UID" property value                already in use by another scheduling object resource                owned by the same user in other calendar collections.                Servers SHOULD report the URL of the scheduling object                resource that is already making use of the same "UID"                property value in the DAV:href element.              </t>              <t hangText="Definition:">                <figure><artwork><![CDATA[  <!ELEMENT unique-scheduling-object-resource (DAV:href?)>]]></artwork></figure>              </t>              <t hangText="Example:">                <figure><artwork><![CDATA[  <C:unique-scheduling-object-resource xmlns:D="DAV:"      xmlns:C="urn:ietf:params:xml:ns:caldav">    <D:href>/home/bernard/calendars/personal/abc123.ics</D:href>  </C:unique-scheduling-object-resource>]]></artwork></figure>              </t>            </list>          </t>        </section>        <section title="CALDAV:same-organizer-in-all-components Precondition">          <t>            <list style="hanging">              <t hangText="Name:">same-organizer-in-all-components</t>              <t hangText="Namespace:">urn:ietf:params:xml:ns:caldav</t>              <t hangText="Apply to:">PUT, COPY, and MOVE</t>              <t hangText="Use with:">403 Forbidden</t>              <t hangText="Purpose:">                (precondition) -- All the calendar components in a                scheduling object resource MUST contain the same "ORGANIZER"                property value when present.              </t>              <t hangText="Definition:">                <figure><artwork><![CDATA[  <!ELEMENT same-organizer-in-all-components EMPTY>]]></artwork></figure>              </t>            </list>          </t>        </section>        <section title="CALDAV:allowed-organizer-scheduling-object-change Precondition" anchor='allowed-organizer-scheduling-object-change'>          <t>            <list style="hanging">              <t hangText="Name:">allowed-organizer-scheduling-object-change</t>              <t hangText="Namespace:">urn:ietf:params:xml:ns:caldav</t>              <t hangText="Apply to:">PUT, COPY, and MOVE</t>              <t hangText="Use with:">403 Forbidden</t>              <t hangText="Purpose:">                (precondition) --                 Servers MAY impose restrictions on modifications allowed by an                Organizer. For instance, servers MAY prevent the Organizer                setting the "PARTSTAT" property parameter to a value other than                "NEEDS-ACTION" if the corresponding "ATTENDEE" property has                the "SCHEDULE-AGENT" property parameter set to "SERVER",                or has no "SCHEDULE-AGENT" property parameter. See <xref                target="organizer-scheduling"/>.              </t>              <t hangText="Definition:">                <figure><artwork><![CDATA[  <!ELEMENT allowed-organizer-scheduling-object-change EMPTY>]]></artwork></figure>              </t>            </list>          </t>        </section>        <section title="CALDAV:allowed-attendee-scheduling-object-change Precondition" anchor='allowed-attendee-scheduling-object-change'>          <t>            <list style="hanging">              <t hangText="Name:">allowed-attendee-scheduling-object-change</t>              <t hangText="Namespace:">urn:ietf:params:xml:ns:caldav</t>              <t hangText="Apply to:">PUT, COPY, and MOVE</t>              <t hangText="Use with:">403 Forbidden</t>              <t hangText="Purpose:">                (precondition) --                 Servers MAY impose restrictions on modifications allowed                 by an Attendee, subject to the allowed changes specified in <xref target="Allowed-Attendee-Changes"/>.              </t>              <t hangText="Definition:">                <figure><artwork><![CDATA[  <!ELEMENT allowed-attendee-scheduling-object-change EMPTY>]]></artwork></figure>              </t>            </list>          </t>        </section>      </section>      <section title="DTSTAMP and SEQUENCE Properties">        <t>          The server MUST ensure that a          "DTSTAMP" iCalendar property is present and set          the value to the UTC time that the scheduling message          was generated (as required by iCalendar).        </t>        <t>          The server MUST ensure          that for each type of scheduling operation, the "SEQUENCE"          iCalendar property value is updated as per <xref target="RFC5546">iTIP</xref>.        </t>      </section>      <section title="Restrict Recurrence Instances Sent to Attendees"        anchor="limiting-recurrence-instances">        <t>          Servers MUST ensure that Attendees          only get information about recurrence instances that          explicitly include them as an Attendee, when delivering scheduling messages for recurring calendar components.        </t>        <t>          For example, if an Attendee is invited to only a single          instance of a recurring event, the organizer scheduling          object resource will contain an overridden instance in the form          of a separate calendar component. That separate calendar          component will include the "ATTENDEE" property referencing          the "one-off" Attendee. That Attendee will not be listed          in any other calendar components in the scheduling object          resource. Any scheduling messages delivered          to the Attendee will only contain information about this          overridden instance.        </t>        <t>          As another example, an Attendee could be excluded from one          instance of a recurring event. In that case the organizer scheduling          object resource will include an overridden instance with an          "ATTENDEE" list that does not include the Attendee being          excluded. Any scheduling messages delivered to          the Attendee will not specify the overridden instance but          rather include an "EXDATE" property in the "master"          component that defines the recurrence set.        </t>      </section>      <section title="Forcing the Server to Send a Scheduling Message">        <t>          The iCalendar property parameter "SCHEDULE-FORCE-SEND" defined          in <xref target="schedule-force-send"/> can be used          by a calendar user to force the server to send a scheduling          message to an Attendee or the Organizer in a situation where          the server would not normally send a scheduling message.          For instance, an Organizer could use this property parameter          to request an Attendee, that previously declined an invitation,          to reconsider their participation status without being forced to          modify the event.        </t>      </section>      <section title="Attendee Participation Status">        <t>          This section specifies additional requirements on the handling          of the "PARTSTAT" property parameter when the "SCHEDULE-AGENT"          property parameter on the corresponding "ATTENDEE" property is          set to the value "SERVER" or is not present.        </t>        <t>A reschedule occurs when any "DTSTART", "DTEND", "DURATION", "DUE", "RRULE", "RDATE", or "EXDATE" property changes in a calendar component such that existing recurrence instances are impacted by the changes, as shown in the table below. Servers MUST reset the "PARTSTAT" property parameter value of all "ATTENDEE" properties, except the one that corresponds to the Organizer, to "NEEDS-ACTION" for each calendar component change that causes any instance to be rescheduled.        </t>        <texttable>          <ttcol>Property</ttcol>          <ttcol>Server Action</ttcol>          <c>DTSTART, DTEND, DURATION, DUE</c>          <c>Any change to these properties result in "PARTSTAT" being set to "NEEDS-ACTION"</c>          <c>&nbsp;</c><c>&nbsp;</c>          <c>RRULE</c>          <c>A change to or addition of this property that results in the addition of new recurring instances or a change in time for existing recurring instances result in "PARTSTAT" being reset to "NEEDS-ACTION" on each affected component.</c>          <c>&nbsp;</c><c>&nbsp;</c>          <c>RDATE</c>          <c>A change to or addition of this property that results in the addition of new recurring instances or a change in time for existing recurring instances result in "PARTSTAT" being reset to "NEEDS-ACTION" on each affected component.</c>          <c>&nbsp;</c><c>&nbsp;</c>          <c>EXDATE</c>          <c>A change to or removal of this property that results in the re-instatement of recurring instances result in "PARTSTAT" being set to "NEEDS-ACTION" on each affected component.</c>        </texttable>            <t>          The server MAY allow the Organizer's client to change an          Attendee's "PARTSTAT" property parameter value to "NEEDS-ACTION"          at any other time (e.g., when the "LOCATION" property value          changes, an Organizer might wish to re-invite Attendees who          might be impacted by the change).        </t>      </section>      <section title="Schedule Status Values" anchor="schedule-status-value">        <t>When scheduling with an Attendee there are two types of status information that can be returned during the operation. The first type of status information is a "delivery" status that indicates whether the scheduling message from the Organizer to the Attendee was delivered or not, or what the current status of delivery is. The second type of status information is a "reply" status corresponding to the Attendee's own "REQUEST-STATUS" information from the scheduling message reply that is sent back to the Organizer.</t>        <t>Similarly, when an Attendee sends a reply back to the Organizer, there will be "delivery" status information for the scheduling message sent to the Organizer. However, there is no "REQUEST-STATUS" sent back by the Organizer, so there is no equivalent of the "reply" status as per scheduling messages to Attendees.</t>        <t>The "delivery" status information on an "ORGANIZER" or "ATTENDEE" iCalendar property is conveyed in the "SCHEDULE-STATUS" property parameter value (<xref target="schedule-status"/>). The status code value for "delivery" status can be one of the following:</t>        <texttable>            <ttcol>Delivery Status Code</ttcol>            <ttcol>Description</ttcol>            <c>1.0</c>            <c>The scheduling message is pending. i.e. the server is still in the process of sending the message. The status code value can be expected to change once the server has completed its sending and delivery attempts.</c>            <c>&nbsp;</c>            <c>&nbsp;</c>            <c>1.1</c>            <c>The scheduling message has been successfully sent. However, the server does not have explicit information about whether the scheduling message was successfully delivered to the recipient. This state can occur with "store and forward" style scheduling protocols such as <xref target="RFC6047">iMIP</xref> (iTIP using email).</c>            <c>&nbsp;</c>            <c>&nbsp;</c>            <c>1.2</c>            <c>The scheduling message has been successfully delivered.</c>            <c>&nbsp;</c>            <c>&nbsp;</c>            <c>3.7</c>            <c>The scheduling message was not delivered because the server did not recognize the calendar user address as a valid calendar user. Note that this code applies to both Organizer and Attendee calendar user addresses.</c>            <c>&nbsp;</c>            <c>&nbsp;</c>            <c>3.8</c>            <c>The scheduling message was not delivered due to insufficient privileges. Note that this code applies to both privileges granted by both the Organizer and Attendee calendar users.</c>            <c>&nbsp;</c>            <c>&nbsp;</c>            <c>5.1</c>            <c>The scheduling message was not delivered because the server could not complete delivery of the message. This is likely due to a temporary failure, and the originator can try to send the message again at a later time.</c>            <c>&nbsp;</c>            <c>&nbsp;</c>            <c>5.2</c>            <c>The scheduling message was not delivered because the server was not able to find a way to deliver the message. This is likely a permanent failure, and the originator ought not try to send the message again, at least without verifying/correcting the calendar user address of the recipient.</c>            <c>&nbsp;</c>            <c>&nbsp;</c>            <c>5.3</c>            <c>The scheduling message was not delivered and was rejected because scheduling with that recipient is not allowed. This is likely a permanent failure, and the originator ought not try to send the message again.</c>        </texttable>        <t>The status code for "reply" status can be any of the valid <xref target="RFC5546">iTIP</xref> "REQUEST-STATUS" values.</t>        <t>          The 1.xx "REQUEST-STATUS" codes are new.  This specification modifies item (2) of Section 3.6 of <xref target="RFC5546"/> by adding the following restriction:          <list>            <t>For a 1.xx code, all components MUST have exactly the same code.</t>          </list>          Definition of the new 1.xx codes is as follows:        </t>        <section title="Status Code 1.0" toc="exclude" anchor="status1.0">          <t>          <list style="hanging">            <t hangText="Status Code:">1.0</t>            <t hangText="Status Description:">Pending.</t>            <t hangText="Status Exception Data:">None.</t>            <t hangText="Description:">Delivery of the iTIP message is pending.</t>          </list>          </t>        </section>        <section title="Status Code 1.1" toc="exclude" anchor="status1.1">          <t>          <list style="hanging">            <t hangText="Status Code:">1.1</t>            <t hangText="Status Description:">Sent.</t>            <t hangText="Status Exception Data:">None.</t>            <t hangText="Description:">The iTIP message has been sent, though no information about successful delivery is known.</t>          </list>          </t>        </section>        <section title="Status Code 1.2" toc="exclude" anchor="status1.2">          <t>          <list style="hanging">            <t hangText="Status Code:">1.2</t>            <t hangText="Status Description:">Delivered.</t>            <t hangText="Status Exception Data:">None.</t>            <t hangText="Description:">The iTIP message has been sent and delivered.</t>          </list>          </t>        </section>      </section><section title="Avoiding Conflicts when Updating Scheduling Object Resources" anchor="schedule-tag">    <t>      Scheduling object resources on the server might change frequently as      Attendees change their participation status, triggering updates to the      Organizer, and refreshes of other Attendees' copies of the scheduling      object resource. This can lead to an "inconsequential" change to a calendar user's data - one that does not directly impact their own participation status. When this occurs, clients have to reload calendar      data and reconcile with changes being made by calendar      users. To avoid the need for this, the server can instead merge      calendar data changes from a client with changes made as a the result      of a scheduling operation carried out by some other calendar user.    </t>    <t>      This specification introduces a      new WebDAV resource property CALDAV:schedule-tag with a      corresponding response header "Schedule-Tag", and a new      "If-Schedule-Tag-Match" request header to allow client      changes to be appropriately merged with server changes in      the case where the changes on the server were the result      of an "inconsequential" scheduling message update (one which simply      updates the status information of Attendees due to a reply      from another Attendee).    </t>    <t>      Servers MUST automatically resolve conflicts with      "inconsequential" changes done to scheduling object resources when      the "If-Schedule-Tag-Match" request header is specified. The If-Schedule-Tag-Match request header applies only to the      Request-URI, and not to the Destination of a COPY or MOVE.    </t>    <t>A response to any successful GET or PUT request targeting a scheduling object resource MUST include a Schedule-Tag response header with the value set to the same value as the CALDAV:schedule-tag WebDAV property of the resource.    </t>    <t>A response to any successful COPY or MOVE request that specifies a Destination request header targeting a scheduling object resource MUST include a Schedule-Tag response header with the value set to the same value as the CALDAV:schedule-tag WebDAV property of the destination resource.    </t>    <t>      Clients SHOULD use the If-Schedule-Tag-Match header on requests that update scheduling object resources, instead of HTTP ETag-based precondition tests (e.g., If-Match). Normal ETag-based precondition tests are used in all other cases, e.g., for synchronization.    </t>    <t>      The value of the CALDAV:schedule-tag property changes according      to these rules:      <list style="symbols">        <t>For an Organizer's copy of a scheduling object resource:          <list style="numbers">            <t>              The server MUST NOT change the CALDAV:schedule-tag              property value when the scheduling object resource              is updated as the result of automatically processing              a scheduling message reply from an Attendee. For              instance, when an Attendee replies to the Organizer,              the CALDAV:schedule-tag property is unchanged after              the Organizer's scheduling object resource has been              automatically updated by the server with the Attendee's              new participation status.            </t>            <t>              The server MUST change CALDAV:schedule-tag property              value when the scheduling object resource is changed              directly via an HTTP request (e.g., PUT, COPY or MOVE).            </t>          </list>        </t>        <t>          For an Attendee's copy of a scheduling object resource:          <list style="numbers">            <t>              The server MUST change the CALDAV:schedule-tag              property value when the scheduling object resource              is changed as the result of processing a              scheduling message update from an Organizer              that contains changes other than just the participation              status of Attendees.            </t>            <t>              The server MUST NOT change the CALDAV:schedule-tag              property value when the scheduling object resource              is changed as the result of processing a scheduling              message update from an Organizer that only specify              changes in the participation status of Attendees.              For instance, when Attendee "A" replies to Organizer              "O", and Attendee "B" receives a scheduling message              update from Organizer "O" with the new participation              status of Attendee "A", the CALDAV:schedule-tag              property of Attendee "B"s scheduling object resource              would remain the same.            </t>            <t>              The server MUST change the CALDAV:schedule-tag property              value when the scheduling object resource is changed              directly via an HTTP request (e.g., PUT, COPY or MOVE).            </t>          </list>        </t>      </list>    </t>    <section title="PUT">      <t>        Clients MAY use the If-Schedule-Tag-Match request header to do        a PUT request that ensures that "inconsequential"        changes on the server do not result in a precondition        error. The value of the request header is set to the last        Schedule-Tag value received for the resource being modified.        If the value of the If-Schedule-Tag-Match header matches the        current value of the CALDAV:schedule-tag property the server        MUST take any "ATTENDEE" property changes for all Attendees        other than the owner of the scheduling object resource and        apply those to the new resource being stored.        Otherwise, the server MUST fail the request with a 412        Precondition Failed status code.      </t>    </section>    <section title="DELETE, COPY or MOVE">      <t>        Clients MAY use the If-Schedule-Tag-Match request header to do        a DELETE, COPY or MOVE request that ensures that "inconsequential"        changes on the server do not result in a precondition error. The        value of the request header is set to the last Schedule-Tag        value received for the resource being deleted.        If the value of the If-Schedule-Tag-Match header matches the        current value of the CALDAV:schedule-tag property the server        performs the normal DELETE, COPY or MOVE request processing for the resource.        Otherwise, the server MUST fail the request with a 412        Precondition Failed status code.      </t>    </section>  </section>    </section>  </section>  <section title="Processing Incoming Scheduling Messages" anchor='automatic-processing'>    <t>      Scheduling operations can cause the delivery of a scheduling message      into an Organizer's or Attendee's scheduling Inbox collection. Servers      MUST automatically process incoming scheduling messages using the      rules defined by <xref target='RFC5546'/>, by creating or updating the      corresponding scheduling object resources on calendars owned by the      owner of the scheduling Inbox collection. In addition, the scheduling      message is stored in the scheduling Inbox collection as an indicator      to the client that a scheduling operation has taken place. Scheduling messages are typically removed from the scheduling Inbox collection by the client once the calendar user has acknowledged the change.    </t>    <t>      The server MUST take into account privileges      on the scheduling Inbox collection when processing incoming      scheduling messages, to determine whether delivery of the      scheduling message is allowed. Privileges on      calendars containing any matching scheduling object resource are      not considered in this case (i.e., a schedule message from another user can cause modifications to resources in calendar collections that the other user would not normally have read or write access to). Additionally, servers MUST take      into account any scheduling Inbox collection preconditions      (see <xref target="schedule-inbox"/>) when delivering the      scheduling message, and it MUST take into account the similar      preconditions on any calendar collection which contains, or      would contain, the corresponding scheduling object resource.    </t>    <section title="Processing Organizer Requests, Additions, and Cancellations">      <t>        For a scheduling message sent by an Organizer, the server first        tries to locate a corresponding scheduling object resource        belonging to the Attendee. If no matching scheduling object        resource exists, the server treats the scheduling message as        a new message, otherwise it is treated as an update.      </t>      <t>        In the case of a new message, the server processes the        scheduling message and creates a new scheduling object resource        as per <xref target="default-calendar"/>.      </t>      <t>        In the case of an update, the server processes the        scheduling message and updates the matching scheduling        object resource belonging to the Attendee to reflect        the changes sent by the Organizer.      </t>      <t>        In each case, the scheduling message MUST only appear        in the Attendee's scheduling Inbox collection once all        automatic processing has been done.      </t>    </section>    <section title="Processing Attendee Replies">      <t>        For a scheduling message reply sent by an Attendee, the        server first locates the corresponding scheduling object        resource belonging to the Organizer. If the corresponding scheduling object resource cannot be found, the server SHOULD ignore the scheduling message.      </t>      <t>        The server MUST then update the "PARTSTAT" iCalendar property parameter        value of each "ATTENDEE" iCalendar property in the scheduling        object resource to match the changes indicated in the reply        (taking into account the fact that an Attendee could have        created a new overridden iCalendar component to indicate        different participation status on one or more        instances of a recurring event).      </t>      <t>        The server MUST also update or add the "SCHEDULE-STATUS"        property parameter on each matching "ATTENDEE" iCalendar        property and set its value to that of the "REQUEST-STATUS"        property in the reply, or to "2.0" if "REQUEST-STATUS" is not        present (also taking into account recurrence instances). If        there are multiple "REQUEST-STATUS" properties in the        reply, the "SCHEDULE-STATUS" property parameter value is        set to a comma-separated list of status codes, one from each        "REQUEST-STATUS" property.      </t>      <t>        The server SHOULD send scheduling messages to all the other        Attendees indicating the change in participation status of        the Attendee replying, subject to the recurrence requirements        of <xref target="limiting-recurrence-instances"/>.      </t>      <t>        The scheduling message MUST only appear in the        Organizer's scheduling Inbox collection once all automatic        processing has been done.      </t>    </section>    <section title="Default Calendar Collection" anchor="default-calendar">      <t>        The server processes scheduling messages received for an Attendee by creating a new scheduling object        resource in a calendar collection belonging to the Attendee, when one does not already exist. A calendar user        that is an Attendee in a scheduling operation        MUST have at least one valid calendar collection available.  If there is no valid        calendar collection, then the server MUST reject the attempt to        deliver the scheduling message to the Attendee.      </t>      <t>        Servers MAY provide support for a default calendar collection, that is,        the calendar collection in which new scheduling object resources will be        created. The CALDAV:schedule-default-calendar-URL        WebDAV property, which can be present on the scheduling Inbox        collection of a calendar user, specifies if this calendar user has a        default calendar collection. See        <xref target="PROPERTY_schedule-default-calendar-URL"/>.      </t>      <t>        Servers SHOULD create new scheduling object resources in the default calendar collection, if the CALDAV:schedule-default-calendar-URL WebDAV property is set.      </t>      <t>        Servers MAY allow clients to change the default        calendar collection by changing the value of the        CALDAV:schedule-default-calendar-URL WebDAV property on the        scheduling Inbox collection. However, the server MUST ensure that        any new value for that property refers to a valid        calendar collection belonging to the owner of the scheduling        Inbox collection.      </t>      <t>        Servers MUST reject any attempt to delete the default calendar        collection.      </t>      <section title="Additional Method Preconditions">        <t>          This specification defines additional method preconditions          (see Section 16 of <xref target="RFC4918">WebDAV</xref>)          to provide machine-parseable information in error responses.        </t>        <section title="CALDAV:default-calendar-needed Precondition">          <t>            <list style="hanging">              <t hangText="Name:">default-calendar-needed</t>              <t hangText="Namespace:">urn:ietf:params:xml:ns:caldav</t>              <t hangText="Apply to:">DELETE</t>              <t hangText="Use with:">403 Forbidden</t>              <t hangText="Purpose:">                (precondition) --                The client attempted to delete the calendar collection                currently referenced by the                CALDAV:schedule-default-calendar-URL property, or attempted                to remove the CALDAV:schedule-default-calendar-URL property                on the scheduling Inbox collection on a server that doesn't                allow such operations.              </t>              <t hangText="Definition:">                <figure><artwork><![CDATA[  <!ELEMENT default-calendar-needed EMPTY>]]></artwork></figure>              </t>            </list>          </t>        </section>        <section title="CALDAV:valid-schedule-default-calendar-URL Precondition">          <t>            <list style="hanging">              <t hangText="Name:">valid-schedule-default-calendar-URL</t>              <t hangText="Namespace:">urn:ietf:params:xml:ns:caldav</t>              <t hangText="Apply to:">PROPPATCH</t>              <t hangText="Use with:">403 Forbidden</t>              <t hangText="Purpose:">                (precondition) --                The client attempted to set the                CALDAV:schedule-default-calendar-URL property to a DAV:href                element that doesn't reference a valid calendar collection.                Note: Servers that do not allow clients to change the                CALDAV:schedule-default-calendar-URL property would simply                return the DAV:cannot-modify-protected-property precondition                defined in Section 16 of <xref target="RFC4918">WebDAV</xref>.              </t>              <t hangText="Definition:">                <figure><artwork><![CDATA[  <!ELEMENT valid-schedule-default-calendar-URL EMPTY>]]></artwork></figure>              </t>            </list>          </t>        </section>      </section>    </section>  </section>  <section title="Request for Busy Time Information" anchor="freebusy">    <t>Busy time information of one or more calendar users can be determined by submitting a POST request targeted at the scheduling Outbox collection of the calendar user requesting the information (the Organizer). To accomplish this, the request body MUST contain a "VFREEBUSY" calendar component with the "METHOD" iCalendar property set to the value "REQUEST" as specified in Section 3.3.2 of <xref target="RFC5546">iTIP</xref>. The resource identified by the Request-URI MUST be a resource collection of type <xref target="schedule-outbox">CALDAV:schedule-outbox</xref>. The "ORGANIZER" property value in the "VFREEBUSY" component MUST match one of the calendar user addresses of the owner of the Outbox collection.    </t>    <t>A response to a busy time request that indicates status for one or more calendar users MUST be an XML document with a CALDAV:schedule-response XML element as its root element. This element MUST contain one CALDAV:response element for each calendar user, with each of those containing elements that indicate which calendar user they correspond to, the scheduling status for that calendar user, any error codes and an optional description. For a successful busy time request, a CALDAV:calendar-data element is also present for each calendar user, containing the actual busy time information (i.e., an iCalendar "VFREEBUSY" component). See <xref target="schedule_response_element"/> for the detail on the child elements. See <xref target="freebusy_example"/> for an example busy time request and response.    </t>    <section title="Status Codes">      <t>        The list below summarizes the most common status codes used        for this method. However, clients need to be prepared to handle other        2/3/4/5xx series status codes as well.      </t>      <t>        <list>          <t>            200 (OK) -            The command succeeded.          </t>          <t>            204 (No Content) -            The command succeeded.          </t>          <t>            400 (Bad Request) -            The client has provided an invalid scheduling message.          </t>          <t>            403 (Forbidden) -            The client cannot submit a scheduling message to the            specified Request-URI.          </t>          <t>            404 (Not Found) -            The URL in the Request-URI was not present.          </t>          <t>            423 (Locked) - The specified resource is locked and            the client either is not a lock owner or the lock type            requires a lock token to be submitted and the client did            not submit it.          </t>        </list>      </t>    </section>    <section title="Additional Method Preconditions">      <t>        The following are existing preconditions that are reused for the        POST method on an Outbox collection.        <list style='symbols'>            <t><xref target="RFC3744">DAV:need-privileges</xref></t>            <t><xref target="RFC4791">CALDAV:supported-calendar-data</xref></t>            <t><xref target="RFC4791">CALDAV:valid-calendar-data</xref></t>            <t><xref target="RFC4791">CALDAV:max-resource-size</xref></t>        </list>      </t>      <t>        The following are new method preconditions        for the POST method on an Outbox collection.      </t>      <section title="CALDAV:valid-scheduling-message Precondition">        <t>          <list style="hanging">            <t hangText="Name:">valid-scheduling-message</t>            <t hangText="Namespace:">urn:ietf:params:xml:ns:caldav</t>            <t hangText="Apply to:">POST</t>            <t hangText="Use with:">400 Bad Request</t>            <t hangText="Purpose:">(precondition) -- The resource submitted in the POST request MUST obey all the restrictions specified in Section 3.3.2 of <xref target="RFC5546">iTIP</xref>.            </t>            <t hangText="Definition:">              <figure><artwork><![CDATA[  <!ELEMENT valid-scheduling-message EMPTY>]]></artwork></figure>            </t>          </list>        </t>      </section>      <section title="CALDAV:valid-organizer Precondition">        <t>          <list style="hanging">            <t hangText="Name:">valid-organizer</t>            <t hangText="Namespace:">urn:ietf:params:xml:ns:caldav</t>            <t hangText="Apply to:">POST</t>            <t hangText="Use with:">403 Forbidden</t>            <t hangText="Purpose:">(precondition) -- The "ORGANIZER" property value in the POST request's scheduling message MUST match one of the calendar user addresses of the owner of the scheduling Outbox collection being targeted by the request;            </t>            <t hangText="Definition:">              <figure><artwork><![CDATA[  <!ELEMENT valid-organizer EMPTY>]]></artwork></figure>            </t>          </list>        </t>      </section>  </section></section>    <section title="Scheduling Privileges" anchor="scheduling_acl">        <t>New scheduling privileges are defined in this section. All the scheduling privileges MUST be non-abstract and MUST appear in the DAV:supported-privilege-set property of scheduling Outbox and Inbox collections on which they are defined.</t>        <t>The tables specified in <xref target="privilege_summary"/> clarify which scheduling methods (e.g., "REQUEST", "REPLY", etc.) are controlled by each scheduling privilege defined in this section.</t>        <section title="Privileges on Scheduling Inbox Collections">            <t>This section defines new <xref target="RFC3744">WebDAV ACL</xref> privileges that are for use on scheduling Inbox collections. These privileges determine whether delivery of scheduling messages from a calendar user is allowed by the calendar user who "owns" the scheduling Inbox collection. This allows calendar users to choose which other calendar users can schedule with them.</t>            <t>Note that when a scheduling message is delivered to a calendar user, in addition to a scheduling object resource being created in the calendar user's scheduling Inbox collection, a new scheduling object resource might be created or an existing one updated in a calendar belonging to the calendar user. In that case, the ability to create or update the scheduling object resource in the calendar is controlled by the privileges assigned to the scheduling Inbox collection.</t>            <t>The privileges defined in this section are ignored if applied to a resource other than a scheduling Inbox collection.</t>        <section title="CALDAV:schedule-deliver Privilege"                 anchor="PRIVILEGE_schedule-deliver">          <t>CALDAV:schedule-deliver is an aggregate privilege as per <xref target="aggregate"/>.</t>          <t><figure><artwork><![CDATA[  <!ELEMENT schedule-deliver EMPTY>]]></artwork></figure></t>        </section>        <section title="CALDAV:schedule-deliver-invite Privilege"                 anchor="PRIVILEGE_schedule-deliver-invite">          <t>The CALDAV:schedule-deliver-invite privilege controls the processing and delivery of scheduling messages coming from an Organizer.</t>          <t><figure><artwork><![CDATA[  <!ELEMENT schedule-deliver-invite EMPTY>]]></artwork></figure></t>        </section>        <section title="CALDAV:schedule-deliver-reply Privilege"                 anchor="PRIVILEGE_schedule-deliver-reply">          <t>The CALDAV:schedule-deliver-reply privilege controls the processing and delivery of scheduling messages coming from an Attendee.</t>          <t><figure><artwork><![CDATA[  <!ELEMENT schedule-deliver-reply EMPTY>]]></artwork></figure></t>        </section>        <section title="CALDAV:schedule-query-freebusy Privilege"                 anchor="PRIVILEGE_schedule-query-freebusy">          <t>The CALDAV:schedule-query-freebusy privilege controls freebusy requests targeted at the owner of the scheduling Inbox collection.</t>          <t><figure><artwork><![CDATA[  <!ELEMENT schedule-query-freebusy EMPTY>]]></artwork></figure></t>        </section>        </section>        <section title="Privileges on Scheduling Outbox Collections">            <t>This section defines new <xref target="RFC3744">WebDAV ACL</xref> privileges that are defined for use on scheduling Outbox collections. These privileges determine which calendar users are allowed to send scheduling messages on behalf of the calendar user who "owns" the scheduling Outbox collection. This allows calendar users to choose other calendar users who can act on their behalf (e.g. assistants working on behalf of their boss).</t>            <t>The privileges defined in this section are ignored if applied to a resource other than a scheduling Outbox collection.</t>        <section title="CALDAV:schedule-send Privilege"                 anchor="PRIVILEGE_schedule-send">          <t>CALDAV:schedule-send is an aggregate privilege as per <xref target="aggregate"/>.</t>          <t><figure><artwork><![CDATA[  <!ELEMENT schedule-send EMPTY>]]></artwork></figure></t>        </section>        <section title="CALDAV:schedule-send-invite Privilege"                 anchor="PRIVILEGE_schedule-send-invite">          <t>The CALDAV:schedule-send-invite privilege controls the sending of scheduling messages by Organizers.</t>          <t>Users granted the DAV:bind privilege on a calendar collection, or DAV:write privilege on scheduling object resources, will also need the CALDAV:schedule-send-invite privilege granted on the scheduling Outbox collection of the owner of the calendar collection or scheduling object resource in order to be allowed to create, modify or delete scheduling object resources in a way that will trigger the CalDAV server to deliver scheduling messages to attendees.</t>          <t><figure><artwork><![CDATA[  <!ELEMENT schedule-send-invite EMPTY>]]></artwork></figure></t>        </section>        <section title="CALDAV:schedule-send-reply Privilege"                 anchor="PRIVILEGE_schedule-send-reply">          <t>The CALDAV:schedule-send-reply privilege controls the sending of scheduling messages by Attendees.</t>          <t>Users granted the DAV:bind privilege on a calendar collection, or DAV:write privilege on scheduling object resources, will also need the CALDAV:schedule-send-reply privilege granted on the scheduling Outbox collection of the owner of the calendar collection or scheduling object resource in order to be allowed to create, modify or delete scheduling object resources in a way that will trigger the CalDAV server to deliver scheduling message replies to the organizer.</t>          <t><figure><artwork><![CDATA[  <!ELEMENT schedule-send-reply EMPTY>]]></artwork></figure></t>        </section>        <section title="CALDAV:schedule-send-freebusy Privilege"                 anchor="PRIVILEGE_schedule-send-freebusy">          <t>The CALDAV:schedule-send-freebusy privilege controls the use of the POST method to submit scheduling messages that specify the scheduling method "REQUEST" with a "VFREEBUSY" calendar component.</t>          <t><figure><artwork><![CDATA[  <!ELEMENT schedule-send-freebusy EMPTY>]]></artwork></figure></t>        </section>        </section>        <section title="Aggregation of Scheduling Privileges" anchor="aggregate">          <t>Server implementations MUST aggregate the scheduling privileges as follows:            <list>              <t>DAV:all contains CALDAV:schedule-send and CALDAV:schedule-deliver;</t>              <t>CALDAV:schedule-send contains CALDAV:schedule-send-invite, CALDAV:schedule-send-reply, and CALDAV:schedule-send-freebusy;</t>              <t>CALDAV:schedule-deliver contains CALDAV:schedule-deliver-invite, CALDAV:schedule-deliver-reply, and CALDAV:schedule-query-freebusy.</t>            </list>          </t>          <t>The following diagram illustrates how scheduling privileges are aggregated according to the above requirements.            <figure><artwork><![CDATA[[DAV:all] (aggregate)    |    +-- [CALDAV:schedule-deliver] (aggregate)    |      |    |      +-- [CALDAV:schedule-deliver-invite]    |      +-- [CALDAV:schedule-deliver-reply]    |      +-- [CALDAV:schedule-query-freebusy]    |    +-- [CALDAV:schedule-send] (aggregate)           |           +-- [CALDAV:schedule-send-invite]           +-- [CALDAV:schedule-send-reply]           +-- [CALDAV:schedule-send-freebusy]]]></artwork></figure>          </t>        </section>    </section>    <section title="Additional iCalendar Property Parameters">      <t>        This specification defines additional iCalendar property        parameters to support the CalDAV scheduling extensions.      </t>      <section title="Schedule Agent Parameter" anchor="schedule-agent">        <t>          <list style="hanging">            <t hangText="Parameter Name:">SCHEDULE-AGENT</t>            <t hangText="Purpose:">              To specify the agent expected to deliver scheduling              messages to the corresponding Organizer or Attendee.            </t>            <t hangText="Format Definition:">              This property parameter is defined by the following notation:               <figure><artwork name="abnf-rfc5234"><![CDATA[  scheduleagentparam = "SCHEDULE-AGENT" "="                   ("SERVER"      ; The server handles scheduling                  / "CLIENT"      ; The client handles scheduling                  / "NONE"        ; No scheduling                  / x-name        ; Experimental type                  / iana-token)   ; Other IANA registered type  ;  ; If the parameter is not present its value defaults to SERVER.  ; "x-name" and "iana-token" are defined in Section 3.1 of  ; [RFC5545].]]></artwork></figure></t>            <t hangText="Description:">              This property parameter MAY be specified on "ORGANIZER" or "ATTENDEE"              iCalendar properties. In the absence of this parameter, the              value "SERVER" MUST be used for the default behavior.              The value determines whether or not a scheduling              operation on a server will cause a scheduling message              to be sent to the corresponding calendar user identified              by the "ORGANIZER" or "ATTENDEE" property value. When the value "SERVER"              is specified, or the parameter is absent, then it is the              server's responsibility to send a scheduling message as              part of a scheduling operation. When the value              "CLIENT" is specified, that indicates that the client              is handling scheduling messages with the calendar user              itself. When "NONE" is specified, no scheduling messages              are being sent to the calendar user.            </t>            <t>              Servers MUST NOT include this parameter in any scheduling              messages sent as the result of a scheduling              operation.            </t>            <t>              Clients MUST NOT include this parameter in any scheduling              messages that they themselves send.            </t>            <t>              The parameter value MUST be the same on every "ORGANIZER" property in a scheduling object resource.            </t>            <t>              The parameter value MUST be the same on each "ATTENDEE" property whose values match in a scheduling object resource.            </t>            <t>              Servers and clients MUST treat x-name and iana-token              values they do not recognize the same way as they would              the "NONE" value.            </t>            <t hangText="Example:">              <figure><artwork><![CDATA[  ORGANIZER;SCHEDULE-AGENT=SERVER:mailto:bernard@example.com  ATTENDEE;SCHEDULE-AGENT=NONE:mailto:cyrus@example.com]]></artwork></figure>            </t>          </list>        </t>      </section>      <section title="Schedule Force Send Parameter"               anchor="schedule-force-send">        <t>          <list style="hanging">            <t hangText="Parameter Name:">SCHEDULE-FORCE-SEND</t>            <t hangText="Purpose:">              To force a scheduling message to be sent to the calendar              user specified by the property.            </t>            <t hangText="Format Definition:">              This property parameter is defined by the following notation:              <figure><artwork name="abnf-rfc5234"><![CDATA[  scheduleforcesendparam = "SCHEDULE-FORCE-SEND" "="                         ("REQUEST"    ; Force a "REQUEST"                        / "REPLY"      ; Force a "REPLY"                        / iana-token)  ;  ; "iana-token" is defined in Section 3.1 of [RFC5545]. Its value  ; MUST be an IANA registered iCalendar "METHOD" property value.]]></artwork></figure></t>            <t hangText="Description:">              This property parameter MAY be specified on "ATTENDEE"              and "ORGANIZER" properties on which the "SCHEDULE-AGENT"              property parameter is set to the value "SERVER" or is              not specified.              This property parameter is used to force a server to send              a scheduling message to a specific calendar user in              situations where the server would not send a scheduling              message otherwise (e.g., when no change that warrants the              delivery of a new scheduling message was performed on              the scheduling object resource).              An Organizer MAY specify this parameter on an "ATTENDEE"              property with the value "REQUEST" to force a "REQUEST"              scheduling message to be sent to this Attendee.              An Attendee MAY specify this parameter on the "ORGANIZER"              with the value "REPLY" to force a "REPLY" scheduling              message to be sent to the Organizer.            </t>            <t>              Servers MUST NOT preserve this property parameter in              scheduling object resources, nor include it in any              scheduling messages sent as the result of a scheduling operation.            </t>            <t>              Clients MUST NOT include this parameter in any scheduling              messages that they themselves send.            </t>            <t>              Servers MUST set the "SCHEDULE-STATUS" parameter of the              "ATTENDEE" or "ORGANIZER" to 2.3 (i.e., "Success, invalid              property parameter ignored", see Section 3.6 of              <xref target="RFC5546"/>)              when the "SCHEDULE-FORCE-SEND" parameter is set to              an iana-token value they do not recognize.            </t>            <t hangText="Example:">              <figure><artwork><![CDATA[  ORGANIZER;SCHEDULE-FORCE-SEND=REPLY:mailto:cyrus@example.com  ATTENDEE;SCHEDULE-FORCE-SEND=REQUEST:mailto:bernard@example.com]]></artwork></figure>             </t>           </list>         </t>       </section>       <section title="Schedule Status Parameter" anchor="schedule-status">         <t>           <list style="hanging">             <t hangText="Parameter Name:">SCHEDULE-STATUS</t>             <t hangText="Purpose:">               To specify the status codes returned from processing of the               most recent scheduling message sent to the corresponding               Attendee, or received from the corresponding Organizer.             </t>             <t hangText="Format Definition:">               This property parameter is defined by the following notation:               <figure><artwork name="abnf-rfc5234"><![CDATA[  schedulestatusparam = "SCHEDULE-STATUS" "="                      ( statcode                     / DQUOTE statcode *("," statcode) DQUOTE)  ;  ; "statcode" is defined in Section 3.8.8.3 of [RFC5545]. Value  ; is a single "statcode" or a comma-separated list of "statcode"  ; values.]]></artwork></figure>             </t>             <t hangText="Description:">              This property parameter MAY be specified on the "ATTENDEE"              and "ORGANIZER" properties.             </t>             <t>Servers MUST only add or change this property parameter on any "ATTENDEE" properties corresponding to calendar users who were sent a scheduling message via a scheduling operation. Clients SHOULD NOT change or remove this parameter if it was provided by the server. In the case where the client is handling the scheduling, the client MAY add, change or remove this parameter to indicate the last scheduling message status it received.             </t>             <t>               Servers MUST add this parameter to any "ORGANIZER"               properties corresponding to calendar users who were sent               a scheduling message reply by an Attendee via a scheduling operation. Clients SHOULD NOT change or remove               this parameter if it was provided by the server. In the               case where the client is handling the scheduling, the client               MAY add, change or remove this parameter to indicate the               last scheduling message status it received.             </t>             <t>Servers MUST NOT include this parameter in any scheduling messages sent as the result of a scheduling operation.</t>             <t>Clients MUST NOT include this parameter in any scheduling messages that they themselves send.</t>             <t>Values for this property parameter are described in <xref target="schedule-status-value"/>.</t>             <t hangText="Example:">               <figure><artwork><![CDATA[  ATTENDEE;SCHEDULE-STATUS="2.0":mailto:bernard@example.com  ATTENDEE;SCHEDULE-STATUS="2.0,2.4":mailto:cyrus@example.com]]></artwork></figure>             </t>           </list>         </t>      </section>    </section>    <section title="Additional Message Header Fields">      <t>        This specification defines additional HTTP request and response        headers for use with CalDAV.      </t>      <section anchor="schedule-reply-header"        title="Schedule-Reply Request Header">        <t>          <figure>            <artwork name="abnf-rfc2616"><![CDATA[  Schedule-Reply = "Schedule-Reply" ":" ("T" | "F")]]></artwork></figure>          <list style="hanging">            <t hangText="Example:">              <figure><artwork><![CDATA[  Schedule-Reply: F]]></artwork></figure>            </t>          </list>        </t>        <t>          When an Attendee removes a scheduling          object resource as per <xref target="attendee_remove"/>, and the Schedule-Reply header is not present,          or present and set to the value "T" (true), the server MUST send an          appropriate reply scheduling message with the Attendee's          "PARTSTAT" iCalendar property parameter value set to "DECLINED"          as part of its normal scheduling operation          processing.        </t>        <t>          When the Schedule-Reply header is set to the value "F" (false), the          server MUST NOT send a scheduling message as part of its          normal scheduling operation processing.        </t>        <t>          The Schedule-Reply request header is used by a client to          indicate to a server whether or not a scheduling          operation ought to occur when an Attendee deletes a scheduling          object resource. In particular it controls whether a reply          scheduling message is sent to the Organizer as a result of the          removal. There are situations in which unsolicited scheduling          messages need to be silently removed (or ignored) for security          or privacy reasons. This request header allows the scheduling          object resource to be removed if such a need arises.        </t>      </section>      <section anchor="schedule-tag-header" title="Schedule-Tag Response Header">        <t>          The Schedule-Tag response header provides the current value of          the CALDAV:schedule-tag property value. The behavior of this          response header is described in <xref target='schedule-tag'/>.        </t>        <t>          All scheduling object resources MUST support the Schedule-Tag          header.        </t>        <figure>          <artwork name="abnf-rfc2616"><![CDATA[  Schedule-Tag = "Schedule-Tag" ":" opaque-tag  ; "opaque-tag" is defined in Section 3.11 of [RFC2616]]]></artwork></figure>        <t>          <list style="hanging">            <t hangText="Example:">              <figure><artwork><![CDATA[  Schedule-Tag: "12ab34-cd56ef"]]></artwork></figure>            </t>          </list>        </t>      </section>      <section title="If-Schedule-Tag-Match Request Header"               anchor="if-schedule-tag-match-header">        <t>          The If-Schedule-Tag-Match request header field is used with a          method to make it conditional. Clients can set this header to          the value returned in the Schedule-Tag response header, or the          CALDAV:schedule-tag property, of a scheduling object resource          previously retrieved from the server to avoid overwriting          "consequential" changes to the scheduling object resource.        </t>        <t>          All scheduling object resources MUST support the          If-Schedule-Tag-Match header.        </t>        <figure>          <artwork name="abnf-rfc2616"><![CDATA[  If-Schedule-Tag-Match = "If-Schedule-Tag-Match" ":" opaque-tag  ; "opaque-tag" is defined in Section 3.11 of [RFC2616]]]></artwork></figure>        <t>          <list style="hanging">            <t hangText="Example:">              <figure><artwork><![CDATA[  If-Schedule-Tag-Match: "12ab34-cd56ef"]]></artwork></figure>            </t>          </list>        </t>      </section>    </section>    <section title="Additional WebDAV Properties">      <t>        This specification defines the following new WebDAV        properties for use with CalDAV.      </t>      <section title="CALDAV:schedule-calendar-transp Property">        <t>          <list style="hanging">            <t hangText="Name:">schedule-calendar-transp</t>            <t hangText="Namespace:">urn:ietf:params:xml:ns:caldav</t>            <t hangText="Purpose:">Determines whether the calendar object resources in a calendar collection will affect the owner's busy time information.</t>            <t hangText="Protected:">This property MAY be protected and SHOULD NOT be returned by a PROPFIND allprop request (as defined in Section 14.2 of <xref target="RFC4918"/>).</t>            <t hangText="COPY/MOVE behavior:">This property value SHOULD be kept during a MOVE operation, and SHOULD be copied and preserved in a COPY.</t>            <t hangText="Description:">This property SHOULD be defined on all calendar collections. If present, it contains one of two XML elements that indicate whether the calendar object resources in the calendar collection ought to contribute to the owner's busy time. When the CALDAV:opaque element is used, all calendar object resources in the corresponding calendar collection MUST contribute to busy time, assuming access privileges and other iCalendar properties allow it to. When the CALDAV:transparent XML element is used, the calendar object resources in the corresponding calendar collection MUST NOT contribute to busy time.</t>            <t>If this property is not present on a calendar collection, then the default value CALDAV:opaque MUST be assumed.</t>            <t hangText="Definition:">              <figure><artwork><![CDATA[  <!ELEMENT schedule-calendar-transp (opaque | transparent)>    <!ELEMENT opaque EMPTY>  <!-- Affect busy time searches -->    <!ELEMENT transparent EMPTY>  <!-- Invisible to busy time searches -->]]></artwork></figure>            </t>            <t hangText="Example:">              <figure><artwork><![CDATA[  <C:schedule-calendar-transp       xmlns:C="urn:ietf:params:xml:ns:caldav">    <C:opaque/>  </C:schedule-calendar-transp>]]></artwork></figure>            </t>          </list>        </t>      </section>      <section anchor="PROPERTY_schedule-default-calendar-URL" title="CALDAV:schedule-default-calendar-URL Property">        <t>          <list style="hanging">            <t hangText="Name:">schedule-default-calendar-URL</t>            <t hangText="Namespace:">urn:ietf:params:xml:ns:caldav</t>            <t hangText="Purpose:">Specifies a default calendar for an Attendee where new scheduling object resources are created.</t>            <t hangText="Protected:">This property MAY be protected in the case where a server does not support changing the default calendar, or does not support a default calendar.</t>            <t hangText="COPY/MOVE behavior:">This property is only defined on a scheduling Inbox collection which cannot be moved or copied.</t>            <t hangText="Description:">This property MAY be defined on a scheduling Inbox collection. If present, it contains zero or one DAV:href XML elements. When a DAV:href element is present, its value indicates a URL to a calendar collection that is used as the default calendar. When no DAV:href element is present, it indicates that there is no default calendar. In the absence of this property there is no default calendar. When there is no default calendar the server is free to choose the calendar in which a new scheduling object resource is created. See <xref target="default-calendar"/>.</t>            <t hangText="Definition:">              <figure><artwork><![CDATA[  <!ELEMENT schedule-default-calendar-URL (DAV:href?)>]]></artwork></figure>            </t>            <t hangText="Example:">              <figure><artwork><![CDATA[  <C:schedule-default-calendar-URL xmlns:D="DAV:"      xmlns:C="urn:ietf:params:xml:ns:caldav">    <D:href>/home/cyrus/calendars/work/</D:href>  </C:schedule-default-calendar-URL>]]></artwork></figure>            </t>          </list>        </t>      </section>      <section title="CALDAV:schedule-tag Property">        <t>          <list style="hanging">            <t hangText="Name:">schedule-tag</t>            <t hangText="Namespace:">urn:ietf:params:xml:ns:caldav</t>            <t hangText="Purpose:">Indicates whether a scheduling object resource has had a "consequential" change made to it.</t>            <t hangText="Value:">opaque-tag (defined in Section 3.11 of <xref target="RFC2616"/>)</t>            <t hangText="Protected:">This property MUST be protected as only the server can update the value.</t>            <t hangText="COPY/MOVE behavior:">This property value is determined by the server and MAY be different from the value on source resource.</t>            <t hangText="Description:">The CALDAV:schedule-tag property MUST be defined on all scheduling object resources. This property is described in <xref target="schedule-tag"/>.</t>            <t hangText="Definition:">              <figure><artwork><![CDATA[  <!ELEMENT schedule-tag (#PCDATA)>]]></artwork></figure>            </t>            <t hangText="Example:">              <figure><artwork><![CDATA[  <C:schedule-tag xmlns:C="urn:ietf:params:xml:ns:caldav"  >"12345-67890"</C:schedule-tag>]]></artwork></figure>            </t>          </list>        </t>      </section>    </section>    <section title="XML Element Definitions">      <section anchor="schedule_response_element" title="CALDAV:schedule-response XML Element">        <t>          <list style="hanging">            <t hangText="Name:">schedule-response</t>            <t hangText="Namespace:">urn:ietf:params:xml:ns:caldav</t>            <t hangText="Purpose:">Contains the set of responses for a POST method request.</t>            <t hangText="Description:">See <xref target="freebusy"/>.</t>            <t hangText="Definition:">              <figure><artwork><![CDATA[  <!ELEMENT schedule-response (response*)>]]></artwork></figure>            </t>          </list>        </t>      </section>      <section anchor="response_element" title="CALDAV:response XML Element">        <t>          <list style="hanging">            <t hangText="Name:">response</t>            <t hangText="Namespace:">urn:ietf:params:xml:ns:caldav</t>            <t hangText="Purpose:">Contains a single response for a POST method request.</t>            <t hangText="Description:">See <xref target="freebusy"/>.</t>            <t hangText="Definition:">              <figure><artwork><![CDATA[  <!ELEMENT response (recipient,                      request-status,                      calendar-data?,                      DAV:error?,                      DAV:responsedescription?)>    <!-- CALDAV:calendar-data is defined in Section 9.6 of  RFC 4791 and when used here uses the definition with  content (#PCDATA) only -->]]></artwork></figure>            </t>          </list>        </t>      </section>      <section anchor="recipient_element" title="CALDAV:recipient XML Element">        <t>          <list style="hanging">            <t hangText="Name:">recipient</t>            <t hangText="Namespace:">urn:ietf:params:xml:ns:caldav</t>            <t hangText="Purpose:">The calendar user address that the enclosing response for a POST method request is for.</t>            <t hangText="Description:">See <xref target="freebusy"/>.</t>            <t hangText="Definition:">              <figure><artwork><![CDATA[  <!ELEMENT recipient (DAV:href)>]]></artwork></figure>            </t>          </list>        </t>      </section>      <section anchor="response_status_element" title="CALDAV:request-status XML Element">        <t>          <list style="hanging">            <t hangText="Name:">request-status</t>            <t hangText="Namespace:">urn:ietf:params:xml:ns:caldav</t>            <t hangText="Purpose:">The iTIP "REQUEST-STATUS" property value for this response.</t>            <t hangText="Description:">See <xref target="freebusy"/>.</t>            <t hangText="Definition:">              <figure><artwork><![CDATA[  <!ELEMENT request-status (#PCDATA)>]]></artwork></figure>            </t>          </list>        </t>      </section>    </section>  <section title="Security Considerations">    <t>      The process of scheduling involves the sending and receiving of      scheduling messages. As a result, the security problems related to      messaging in general are relevant here. In particular the authenticity      of the scheduling messages needs to be verified. Servers and clients      MUST use an HTTP connection protected with TLS as defined in <xref      target="RFC2818"/> for all scheduling operations. Clients MUST use the      procedures detailed in Section 6 of <xref target="RFC6125"/> to verify the      authenticity of the server. Servers MUST make use of <xref      target="RFC2617">HTTP authentication</xref> to verify the authenticity      of the calendar user for whom the client is sending requests.    </t>    <section title="Preventing Denial of Service Attacks" anchor="DOS">      <t>        Servers MUST ensure that clients cannot consume excessive server resources by carrying out "large" scheduling operations. In particular, servers SHOULD enforce CALDAV:max-resource-size, CALDAV:max-instances and CALDAV:max-attendees-per-instance pre-conditions as applicable for scheduling Inbox and Outbox collections.      </t>    </section>    <section title="Verifying Scheduling Operations" anchor="verify_scheduling">      <t>        When handling a scheduling operation:      </t>      <t>        <list style="numbers">          <t>            Servers MUST verify that the principal associated with            the DAV:owner of the calendar collection in which a            scheduling object resource is being manipulated contains a            CALDAV:schedule-outbox-URL property value.          </t>          <t>            Servers MUST verify that the currently authenticated user            has the CALDAV:schedule-send privilege, or a sub-privilege aggregated under this privilege, on the scheduling Outbox collection of the DAV:owner of the calendar collection in which a scheduling            object resource is being manipulated.          </t>          <t>            Servers MUST only deliver scheduling messages to recipients            when the CALDAV:schedule-deliver privilege, or a sub-privilege aggregated under this privilege, is granted on the recipient's scheduling Inbox collection for the principal associated with the DAV:owner of the calendar collection in which a scheduling            object resource is being manipulated.          </t>          <t>            To prevent impersonation of calendar users, the server MUST            verify that the "ORGANIZER" property in an organizer scheduling            object resource matches one of the calendar user addresses            of the DAV:owner of the calendar collection in which the            resource is stored.          </t>          <t>            To prevent spoofing of an existing scheduling object resource,            servers MUST verify that the "UID" iCalendar property value            in a new scheduling object resource does not match that            of an existing scheduling object resource with a different            "ORGANIZER" property value.          </t>        </list>      </t>    </section>    <section title="Verifying Busy Time Information Requests">      <t>        When handling a POST request on a scheduling Outbox collection:      </t>      <t>        <list style="numbers">          <t>            Servers MUST verify that the principal associated with the            calendar user address specified in the "ORGANIZER" property            of the scheduling message data in the request contains a            CALDAV:schedule-outbox-URL property value that matches the            scheduling Outbox collection targeted by the request.          </t>          <t>            Servers MUST verify that the currently authenticated user            has the CALDAV:schedule-send privilege, or a sub-privilege aggregated under this privilege, on the scheduling Outbox collection targeted by the request.          </t>          <t>            Servers MUST only return valid freebusy information for recipients            when the CALDAV:schedule-deliver privilege, or a sub-privilege aggregated under this privilege, is granted on the recipient's scheduling Inbox collection for the principal associated with the DAV:owner of the scheduling Outbox collection targeted by the request.          </t>        </list>      </t>    </section>    <section title="Privacy Issues">      <t>This specification only defines how calendar users on the same server are able to schedule with each other - unauthenticated users have no way to carry out scheduling operations. Access control privileges (as per <xref target='scheduling_acl'/>) can control which of those users can schedule with others. Calendar users not wishing to expose their calendar information to other users can do so by denying privileges to specific users, or all users, for all scheduling operations, or perhaps only freebusy.</t>      <t>Attendees can also use the <xref target="schedule-reply-header">Schedule-Reply request header</xref> with the value set to "F" to prevent notification to an Organizer that a scheduling object resource was deleted. This allows Attendees to remove unwanted scheduling messages without any response to the Organizer.</t>	  <t>Servers MUST NOT expose any private iCalendar data, or WebDAV resource state information (URLs, WebDAV properties, etc) for one calendar user to another via scheduling messages or error responses to scheduling operations. In particular, as per Section 8.1 of <xref target="RFC4918"/>, authorization errors MUST take preference over other errors.	  </t>    </section>        <section title="Mitigation of iTIP Threats">        <t>Section 6.1 of <xref target="RFC5546">iTIP</xref> defines a set of potential threats in a scheduling system, and in Section 6.2 defines recommendations on how those can be addressed in protocols using iTIP. This specification addresses the iTIP threats in the following manner:        <list style="hanging">            <t hangText="Spoofing the Organizer">Addressed by item 4 in <xref target="verify_scheduling"/>.</t>            <t hangText="Spoofing the Attendee">Addressed by item 2 in <xref target="verify_scheduling"/> and <xref target="Allowed-Attendee-Changes"/>.</t>            <t hangText="Unauthorized Replacement of the Organizer">Addressed by item 5 in <xref target="verify_scheduling"/>.</t>            <t hangText="Eavesdropping and Data Integrity">Addressed by requiring TLS.</t>            <t hangText="Flooding a Calendar">Addressed by requirements in <xref target="DOS"/></t>            <t hangText="Unauthorized REFRESH Requests">This specification does not support the REFRESH method.</t>        </list>        </t>    </section>  </section>  <section title="IANA Considerations">    <section title="Message Header Field Registrations">      <t>        The message header fields below are to be added to the Permanent        Message Header Field Registry (see <xref target="RFC3864"/>).      </t>      <section title="Schedule-Reply" anchor="iana_schedule_reply">          <t>Header field name: Schedule-Reply</t>          <t>Applicable protocol: http</t>          <t>Status: standard</t>          <t>Author/Change controller: IETF</t>          <t>Specification document(s): this specification (<xref target="schedule-reply-header"/>)</t>          <t>Related information: none</t>      </section>      <section title="Schedule-Tag">          <t>Header field name: Schedule-Tag</t>          <t>Applicable protocol: http</t>          <t>Status: standard</t>          <t>Author/Change controller: IETF</t>          <t>Specification document(s): this specification (<xref target="schedule-tag-header"/>)</t>          <t>Related information: none</t>      </section>      <section title="If-Schedule-Tag-Match">          <t>Header field name: If-Schedule-Tag-Match</t>          <t>Applicable protocol: http</t>          <t>Status: standard</t>          <t>Author/Change controller: IETF</t>          <t>Specification document(s): this specification (<xref target="if-schedule-tag-match-header"/>)</t>          <t>Related information: none</t>      </section>    </section>    <section title="iCalendar Property Parameter Registrations">      <t>        The following iCalendar property parameters are to be added to        the iCalendar Property Parameter Registry defined in Section        8.3.3 of <xref target="RFC5545"/>.      </t>      <texttable>        <ttcol align="left">Parameter</ttcol>        <ttcol align="left">Status</ttcol>        <ttcol align="left">Reference</ttcol>        <c>SCHEDULE-AGENT</c>        <c>Current</c>        <c>RFC XXXX, <xref target="schedule-agent"/></c>        <c>SCHEDULE-STATUS</c>        <c>Current</c>        <c>RFC XXXX, <xref target="schedule-status"/></c>        <c>SCHEDULE-FORCE-SEND</c>        <c>Current</c>        <c>RFC XXXX, <xref target="schedule-force-send"/></c>      </texttable>    </section>    <section title="iCalendar REQUEST-STATUS Value Registrations">      <t>        The following iCalendar "REQUEST-STATUS" values are to be added to        the iCalendar REQUEST-STATUS Value Registry defined in Section        7.3 of <xref target="RFC5546"/>.      </t>        <texttable>          <ttcol>Status Code</ttcol>          <ttcol>Status</ttcol>          <ttcol>Reference</ttcol>          <c>1.0</c>          <c>Current</c>          <c>RFC XXXX, <xref target="status1.0"/></c>          <c>1.1</c>          <c>Current</c>          <c>RFC XXXX, <xref target="status1.1"/></c>          <c>1.2</c>          <c>Current</c>          <c>RFC XXXX, <xref target="status1.2"/></c>        </texttable>    </section>    <section title="Additional iCalendar Elements Registries">        <t>          This specification adds two new IANA registries for iCalendar elements. Additional codes MAY be used, provided the process described in Section 8.2.1 of <xref target='RFC5545'/> is used to register them.        </t>      <section title="Schedule Agent Values Registry">        <t>          The following table has been used to initialize the          schedule agent values registry.        </t>        <texttable>          <ttcol align="left">Schedule Agent</ttcol>          <ttcol align="left">Status</ttcol>          <ttcol align="left">Reference</ttcol>          <c>SERVER</c>          <c>Current</c>          <c>RFC XXXX, <xref target="schedule-agent"/></c>          <c>CLIENT</c>          <c>Current</c>          <c>RFC XXXX, <xref target="schedule-agent"/></c>          <c>NONE</c>          <c>Current</c>          <c>RFC XXXX, <xref target="schedule-agent"/></c>        </texttable>      </section>      <section title="Schedule Force Send Values Registry">        <t>          The following table has been used to initialize the          schedule send values registry.        </t>        <texttable>          <ttcol align="left">Schedule Force Send</ttcol>          <ttcol align="left">Status</ttcol>          <ttcol align="left">Reference</ttcol>          <c>REQUEST</c>          <c>Current</c>          <c>RFC XXXX, <xref target="schedule-force-send"/></c>          <c>REPLY</c>          <c>Current</c>          <c>RFC XXXX, <xref target="schedule-force-send"/></c>        </texttable>      </section>    </section>  </section>  <section title="Acknowledgements">    <t>      The authors would like to thank the following individuals      for contributing their ideas and support for writing this      specification:      Mike Douglass,      Lisa Dusseault,      Red Dutta,      Jacob Farkas,      Jeffrey Harris,      Helge Hess,      Eliot Lear,      Andrew McMillan,      Alexey Melnikov,      Arnaud Quillaud,      Julian F. Reschke,      Wilfredo Sanchez Vega,      Simon Vaillancourt.    </t>    <t>      The authors would also like to thank the Calendaring and Scheduling      Consortium for advice with this specification, and for organizing      interoperability testing events to help refine it.    </t>  </section></middle><back>  <references title="Normative References">    &rfc2119;    &rfc2616;    &rfc2617;    &rfc2818;    &rfc3744;    &rfc3864;    &rfc4791;    &rfc4918;    &rfc5234;    &rfc5545;    &rfc5546;    &rfc6125;    &W3C.REC-xml-20081126;  </references>  <references title="Informative References">    &rfc6047;  </references>  <section title="Scheduling Privileges Summary" anchor="privilege_summary">    <section title="Scheduling Inbox Privileges">      <t>        The following tables specify which scheduling privileges        grant the right to a calendar user to deliver a scheduling        message to the scheduling Inbox collection of another        calendar user. The appropriate behavior depends on the        calendar component type as well as the scheduling "METHOD"        specified in the scheduling message.      </t>      <figure><artwork><![CDATA[                              +--------------------------------+                              |  METHOD for VEVENT and VTODO   |+-----------------------------+---------+-------+-----+--------+| Scheduling Inbox Privilege  | REQUEST | REPLY | ADD | CANCEL |+-----------------------------+---------+-------+-----+--------+| schedule-deliver            |    *    |   *   |  *  |   *    ||   schedule-deliver-invite   |    *    |       |  *  |   *    ||   schedule-deliver-reply    |         |   *   |     |        ||   schedule-query-freebusy   |         |       |     |        |+-----------------------------+---------+-------+-----+--------+]]></artwork></figure>      <figure><artwork><![CDATA[                              +----------------------+                              | METHOD for VFREEBUSY |+-----------------------------+----------------------+| Scheduling Inbox Privilege  |       REQUEST        |+-----------------------------+----------------------+| schedule-deliver            |          *           ||   schedule-deliver-invite   |                      ||   schedule-deliver-reply    |                      ||   schedule-query-freebusy   |          *           |+-----------------------------+----------------------+]]></artwork></figure>    </section>    <section title="Scheduling Outbox Privileges">      <t>        The following tables specify which scheduling privileges        grant the right to a calendar user to perform busy time        information requests and to submit scheduling messages        to other calendar users as the result of a scheduling        operation. The appropriate behavior depends on the        calendar component type as well as the scheduling "METHOD"        specified in the scheduling message.      </t>      <figure><artwork><![CDATA[                              +--------------------------------+                              |  METHOD for VEVENT and VTODO   |+-----------------------------+---------+-------+-----+--------+| Scheduling Outbox Privilege | REQUEST | REPLY | ADD | CANCEL |+-----------------------------+---------+-------+-----+--------+| schedule-send               |    *    |   *   |  *  |   *    ||   schedule-send-invite      |    *    |       |  *  |   *    ||   schedule-send-reply       |         |   *   |     |        ||   schedule-send-freebusy    |         |       |     |        |+-----------------------------+---------+-------+-----+--------+]]></artwork></figure>      <figure><artwork><![CDATA[                              +----------------------+                              | METHOD for VFREEBUSY |+-----------------------------+----------------------+| Scheduling Outbox Privilege |       REQUEST        |+-----------------------------+----------------------+| schedule-send               |          *           ||   schedule-send-invite      |                      ||   schedule-send-reply       |                      ||   schedule-send-freebusy    |          *           |+-----------------------------+----------------------+]]></artwork></figure>    </section>  </section>  <section title="Example Scheduling Operations">    <t>      This section describes some example scheduling operations that give      a general idea of how scheduling is carried out between CalDAV clients      and servers from the perspective of meeting Organizers and Attendees.    </t>    <t>      The server is assumed to be hosted in the "example.com" domain, and users whose email address is at the "example.com" domain are assumed to be hosted by the server. In addition, the email addresses in the "example.net" domain are also valid email addresses for calendar users hosted by the server. Calendar users with an email address at the "example.org" domain are assumed to not be hosted by the server.    </t>    <t>      In the following examples the requests and responses are incomplete and are only for illustrative purposes. In particular, HTTP authentication headers and behaviors are not shown, even though they are required in normal operation.    </t>    <section title="Example: Organizer Inviting Multiple Attendees">      <t>        In the following example, Cyrus invites Wilfredo, Bernard and Mike        to a single instance event by simply creating a new scheduling object        resource in one of his calendar collections by using the PUT method.      </t>      <figure>        <preamble>&gt;&gt; Request &lt;&lt;</preamble>        <artwork><![CDATA[PUT /home/cyrus/calendars/work/9263504FD3AD.ics HTTP/1.1Host: cal.example.comContent-Type: text/calendar; charset="utf-8"Content-Length: xxxxIf-None-Match: *BEGIN:VCALENDARVERSION:2.0PRODID:-//Example Corp.//CalDAV Client//ENBEGIN:VEVENTUID:9263504FD3ADSEQUENCE:0DTSTAMP:20090602T185254ZDTSTART:20090602T160000ZDTEND:20090602T170000ZTRANSP:OPAQUESUMMARY:LunchORGANIZER;CN="Cyrus Daboo":mailto:cyrus@example.comATTENDEE;CN="Cyrus Daboo";CUTYPE=INDIVIDUAL;PARTSTAT=ACCEPTED: mailto:cyrus@example.comATTENDEE;CN="Wilfredo Sanchez Vega";CUTYPE=INDIVIDUAL;PARTSTAT =NEEDS-ACTION;ROLE=REQ-PARTICIPANT;RSVP=TRUE:mailto:wilfredo@ example.comATTENDEE;CN="Bernard Desruisseaux";CUTYPE=INDIVIDUAL;PARTSTAT= NEEDS-ACTION;ROLE=REQ-PARTICIPANT;RSVP=TRUE:mailto:bernard@ex ample.netATTENDEE;CN="Mike Douglass";CUTYPE=INDIVIDUAL;PARTSTAT=NEEDS-A CTION;RSVP=TRUE:mailto:mike@example.orgEND:VEVENTEND:VCALENDAR]]></artwork></figure>      <figure>        <preamble>&gt;&gt; Response &lt;&lt;</preamble>        <artwork><![CDATA[HTTP/1.1 201 CreatedContent-Length: 0Date: Tue, 02 Jun 2009 18:52:54 GMTLast-Modified: Tue, 02 Jun 2009 18:52:54 GMTETag: "d85561cfe74a4e785eb4639451b434fb"Schedule-Tag: "488177c8-2ea7-4176-a6cb-fab8cfccdea2"]]></artwork></figure>      <t>        Once the event creation has been completed, Cyrus's client will retrieve the event back from the server to get the schedule status of each Attendee, as well as record the Schedule-Tag value for future use. In this example, the server reports that a scheduling message was delivered to Wilfredo, a scheduling message is still pending for Bernard, and the server was unable to deliver a scheduling message to Mike.      </t>      <figure>        <preamble>&gt;&gt; Request &lt;&lt;</preamble>        <artwork><![CDATA[GET /home/cyrus/calendars/work/9263504FD3AD.ics HTTP/1.1Host: cal.example.com]]></artwork></figure>      <figure>        <preamble>&gt;&gt; Response &lt;&lt;</preamble>        <artwork><![CDATA[HTTP/1.1 200 OKDate: Tue, 02 Jun 2009 18:52:58 GMTLast-Modified: Tue, 02 Jun 2009 18:52:58 GMTETag: "eb897deabc8939589da116714bc99265"Schedule-Tag: "488177c8-2ea7-4176-a6cb-fab8cfccdea2"Content-Type: text/calendar; charset="utf-8"Content-Length: xxxxBEGIN:VCALENDARVERSION:2.0PRODID:-//Example Corp.//CalDAV Server//ENBEGIN:VEVENTUID:9263504FD3ADSEQUENCE:0DTSTAMP:20090602T185300ZDTSTART:20090602T160000ZDTEND:20090602T170000ZTRANSP:OPAQUESUMMARY:LunchORGANIZER;CN="Cyrus Daboo":mailto:cyrus@example.comATTENDEE;CN="Cyrus Daboo";CUTYPE=INDIVIDUAL;PARTSTAT=ACCEPTED: mailto:cyrus@example.comATTENDEE;CN="Wilfredo Sanchez Vega";CUTYPE=INDIVIDUAL;PARTSTAT =NEEDS-ACTION;ROLE=REQ-PARTICIPANT;RSVP=TRUE;SCHEDULE-STATUS= 1.2:mailto:wilfredo@e xample.comATTENDEE;CN="Bernard Desruisseaux";CUTYPE=INDIVIDUAL;PARTSTAT= NEEDS-ACTION;ROLE=REQ-PARTICIPANT;RSVP=TRUE;SCHEDULE-STATUS= 1.0:mailto:bernard@example.netATTENDEE;CN="Mike Douglass";CUTYPE=INDIVIDUAL;PARTSTAT=NEEDS-A CTION;RSVP=TRUE;SCHEDULE-STATUS=3.7:mailto:mike@example.orgEND:VEVENTEND:VCALENDAR]]></artwork></figure>    </section>    <section title="Example: Attendee Receiving an Invitation">      <t>        In the following example, Wilfredo's client retrieves and deletes        the new scheduling message that appeared in his scheduling        Inbox collection after the server automatically processed it and        created a new scheduling object resource in his default calendar        collection.      </t>      <figure>        <preamble>&gt;&gt; Request &lt;&lt;</preamble>        <artwork><![CDATA[GET /home/wilfredo/calendars/inbox/27d93fc0a58c.ics HTTP/1.1Host: cal.example.com]]></artwork></figure>      <figure>        <preamble>&gt;&gt; Response &lt;&lt;</preamble>        <artwork><![CDATA[HTTP/1.1 200 OKDate: Tue, 02 Jun 2009 18:59:58 GMTLast-Modified: Tue, 02 Jun 2009 18:59:58 GMTETag: "da116714bc9926c89395895eb897deab"Content-Type: text/calendar; charset="utf-8"Content-Length: xxxxBEGIN:VCALENDARVERSION:2.0PRODID:-//Example Corp.//CalDAV Server//ENMETHOD:REQUESTBEGIN:VEVENTUID:9263504FD3ADSEQUENCE:0DTSTAMP:20090602T185254ZDTSTART:20090602T160000ZDTEND:20090602T170000ZTRANSP:OPAQUESUMMARY:LunchORGANIZER;CN="Cyrus Daboo":mailto:cyrus@example.comATTENDEE;CN="Cyrus Daboo";CUTYPE=INDIVIDUAL;PARTSTAT=ACCEPTED: mailto:cyrus@example.comATTENDEE;CN="Wilfredo Sanchez Vega";CUTYPE=INDIVIDUAL;PARTSTAT =NEEDS-ACTION;ROLE=REQ-PARTICIPANT;RSVP=TRUE:mailto:wilfredo@ example.comATTENDEE;CN="Bernard Desruisseaux";CUTYPE=INDIVIDUAL;PARTSTAT= NEEDS-ACTION;ROLE=REQ-PARTICIPANT;RSVP=TRUE:mailto:bernard@ex ample.netATTENDEE;CN="Mike Douglass";CUTYPE=INDIVIDUAL;PARTSTAT=NEEDS-A CTION;RSVP=TRUE:mailto:mike@example.orgEND:VEVENTEND:VCALENDAR]]></artwork></figure>      <figure>        <preamble>&gt;&gt; Request &lt;&lt;</preamble>        <artwork><![CDATA[DELETE /home/wilfredo/calendars/inbox/27d93fc0a58c.ics HTTP/1.1Host: cal.example.com]]></artwork></figure>      <figure>        <preamble>&gt;&gt; Response &lt;&lt;</preamble>        <artwork><![CDATA[HTTP/1.1 204 No ContentDate: Tue, 02 Jun 2009 20:40:36 GMT ]]></artwork></figure>    </section>    <section title="Example: Attendee Replying to an Invitation">      <t>        In the following example, Wilfredo accepts Cyrus's invitation and sets an alarm reminder on the event. It uses the If-Schedule-Tag-Match precondition behavior to ensure it does not overwrite any significant changes from the organizer that might have occurred after it retrieved the initial resource data.      </t>      <figure>        <preamble>&gt;&gt; Request &lt;&lt;</preamble>        <artwork><![CDATA[PUT /home/wilfredo/calendars/work/BB64861C2228.ics HTTP/1.1Host: cal.example.comIf-Schedule-Tag-Match: "e78f23ed-0188-4bab-938d-2aeb3324c7e8"Content-Type: text/calendar; charset="utf-8"Content-Length: xxxxBEGIN:VCALENDARVERSION:2.0PRODID:-//Example Corp.//CalDAV Client//ENBEGIN:VEVENTUID:9263504FD3ADSEQUENCE:0DTSTAMP:20090602T185254ZDTSTART:20090602T160000ZDTEND:20090602T170000ZTRANSP:OPAQUESUMMARY:LunchORGANIZER;CN="Cyrus Daboo":mailto:cyrus@example.comATTENDEE;CN="Cyrus Daboo";CUTYPE=INDIVIDUAL;PARTSTAT=ACCEPTED: mailto:cyrus@example.comATTENDEE;CN="Wilfredo Sanchez Vega";CUTYPE=INDIVIDUAL;PARTSTAT =ACCEPTED;ROLE=REQ-PARTICIPANT;RSVP=TRUE:mailto:wilfredo@exam ple.comATTENDEE;CN="Bernard Desruisseaux";CUTYPE=INDIVIDUAL;PARTSTAT= NEEDS-ACTION;ROLE=REQ-PARTICIPANT;RSVP=TRUE:mailto:bernard@ex ample.netATTENDEE;CN="Mike Douglass";CUTYPE=INDIVIDUAL;PARTSTAT=NEEDS-A CTION;RSVP=TRUE:mailto:mike@example.orgBEGIN:VALARMTRIGGER:-PT15MACTION:DISPLAYDESCRIPTION:ReminderEND:VALARMEND:VEVENTEND:VCALENDAR]]></artwork></figure>      <figure>        <preamble>&gt;&gt; Response &lt;&lt;</preamble>        <artwork><![CDATA[HTTP/1.1 200 OKContent-Length: 0Date: Tue, 02 Jun 2009 18:57:54 GMTLast-Modified: Tue, 02 Jun 2009 18:57:54 GMTETag: "eb4639451b434fbd85561cfe74a4e785"Schedule-Tag: "8893ee45-eb9d-428f-b53c-c777daf19e41"]]></artwork></figure>      <t>        Once the event modification has been completed, Wilfredo's client        will retrieve the event back from the server to get the schedule        status of the Organizer.      </t>      <figure>        <preamble>&gt;&gt; Request &lt;&lt;</preamble>        <artwork><![CDATA[GET /home/wilfredo/calendars/work/BB64861C2228.ics HTTP/1.1Host: cal.example.com]]></artwork></figure>      <figure>        <preamble>&gt;&gt; Response &lt;&lt;</preamble>        <artwork><![CDATA[HTTP/1.1 200 OKDate: Tue, 02 Jun 2009 19:03:03 GMTLast-Modified: Tue, 02 Jun 2009 19:02:21 GMTETag: "5eb897deabda116714bc9926c8939589"Schedule-Tag: "8893ee45-eb9d-428f-b53c-c777daf19e41"Content-Type: text/calendar; charset="utf-8"Content-Length: xxxxBEGIN:VCALENDARVERSION:2.0PRODID:-//Example Corp.//CalDAV Client//ENBEGIN:VEVENTUID:9263504FD3ADSEQUENCE:0DTSTAMP:20090602T190221ZDTSTART:20090602T160000ZDTEND:20090602T170000ZTRANSP:OPAQUESUMMARY:LunchORGANIZER;CN="Cyrus Daboo";SCHEDULE-STATUS=1.2:mailto:cyrus@ex ample.comATTENDEE;CN="Cyrus Daboo";CUTYPE=INDIVIDUAL;PARTSTAT=ACCEPTED: mailto:cyrus@example.comATTENDEE;CN="Wilfredo Sanchez Vega";CUTYPE=INDIVIDUAL;PARTSTAT =ACCEPTED;ROLE=REQ-PARTICIPANT;RSVP=TRUE:mailto:wilfredo@exam ple.comATTENDEE;CN="Bernard Desruisseaux";CUTYPE=INDIVIDUAL;PARTSTAT= NEEDS-ACTION;ROLE=REQ-PARTICIPANT;RSVP=TRUE:mailto:bernard@ex ample.netATTENDEE;CN="Mike Douglass";CUTYPE=INDIVIDUAL;PARTSTAT=NEEDS-A CTION;RSVP=TRUE:mailto:mike@example.orgBEGIN:VALARMTRIGGER:-PT15MACTION:DISPLAYDESCRIPTION:ReminderEND:VALARMEND:VEVENTEND:VCALENDAR]]></artwork></figure>    </section>    <section title="Example: Organizer Receiving a Reply to an Invitation">      <t>        On reception of Wilfredo's reply, Cyrus's server will        automatically update Cyrus's scheduling object resource, make        Wilfredo's scheduling message available in Cyrus's scheduling Inbox        collection, and deliver an updated scheduling message to Bernard to        share Wilfredo's updated participation status.  In this example,        Cyrus's client retrieves and deletes this scheduling message in his        scheduling Inbox collection.      </t>      <figure>        <preamble>&gt;&gt; Request &lt;&lt;</preamble>        <artwork><![CDATA[GET /home/cyrus/calendars/inbox/c0a58c27d93f.ics HTTP/1.1Host: cal.example.com]]></artwork></figure>      <figure>        <preamble>&gt;&gt; Response &lt;&lt;</preamble>        <artwork><![CDATA[HTTP/1.1 200 OKDate: Tue, 02 Jun 2009 19:05:02 GMTLast-Modified: Tue, 02 Jun 2009 19:04:20 GMTETag: "9265eb897deabc8939589da116714bc9"Content-Type: text/calendar; charset="utf-8"Content-Length: xxxxBEGIN:VCALENDARVERSION:2.0PRODID:-//Example Corp.//CalDAV Server//ENMETHOD:REPLYBEGIN:VEVENTUID:9263504FD3ADSEQUENCE:0DTSTAMP:20090602T185754ZDTSTART:20090602T160000ZDTEND:20090602T170000ZORGANIZER;CN="Cyrus Daboo":mailto:cyrus@example.comATTENDEE;CN="Wilfredo Sanchez Vega";PARTSTAT=ACCEPTED:mailto:w ilfredo@example.comREQUEST-STATUS:2.0;SuccessEND:VEVENTEND:VCALENDAR]]></artwork></figure>      <figure>        <preamble>&gt;&gt; Request &lt;&lt;</preamble>        <artwork><![CDATA[DELETE /home/cyrus/calendars/inbox/c0a58c27d93f.ics HTTP/1.1Host: cal.example.com]]></artwork></figure>      <figure>        <preamble>&gt;&gt; Response &lt;&lt;</preamble>        <artwork><![CDATA[HTTP/1.1 204 No ContentDate: Tue, 02 Jun 2009 19:05:05 GMT]]></artwork></figure>      <t>        Cyrus's client then retrieves the event back from the server        with Wilfredo's updated participation status.      </t>      <figure>        <preamble>&gt;&gt; Request &lt;&lt;</preamble>        <artwork><![CDATA[GET /home/cyrus/calendars/work/9263504FD3AD.ics HTTP/1.1Host: cal.example.com]]></artwork></figure>      <figure>        <preamble>&gt;&gt; Response &lt;&lt;</preamble>        <artwork><![CDATA[HTTP/1.1 200 OKDate: Tue, 02 Jun 2009 19:05:02 GMTLast-Modified: Tue, 02 Jun 2009 19:04:20 GMTETag: "eb897deabc8939589da116714bc99265"Schedule-Tag: "132cab27-1fe3-67ab-de13-abd348d1dee3"Content-Type: text/calendar; charset="utf-8"Content-Length: xxxxBEGIN:VCALENDARVERSION:2.0PRODID:-//Example Corp.//CalDAV Server//ENBEGIN:VEVENTUID:9263504FD3ADSEQUENCE:0DTSTAMP:20090602T190420ZDTSTART:20090602T160000ZDTEND:20090602T170000ZTRANSP:OPAQUESUMMARY:LunchORGANIZER;CN="Cyrus Daboo":mailto:cyrus@example.comATTENDEE;CN="Cyrus Daboo";CUTYPE=INDIVIDUAL;PARTSTAT=ACCEPTED: mailto:cyrus@example.comATTENDEE;CN="Wilfredo Sanchez Vega";CUTYPE=INDIVIDUAL;PARTSTAT =ACCEPTED;ROLE=REQ-PARTICIPANT;RSVP=TRUE;SCHEDULE-STATUS=2.0: mailto:wilfredo@example.comATTENDEE;CN="Bernard Desruisseaux";CUTYPE=INDIVIDUAL;PARTSTAT= NEEDS-ACTION;ROLE=REQ-PARTICIPANT;RSVP=TRUE;SCHEDULE-STATUS=1 .0:mailto:bernard@example.netATTENDEE;CN="Mike Douglass";CUTYPE=INDIVIDUAL;PARTSTAT=NEEDS-A CTION;RSVP=TRUE;SCHEDULE-STATUS=3.7:mailto:mike@example.orgEND:VEVENTEND:VCALENDAR]]></artwork></figure>    </section>    <section title="Example: Organizer Requesting Busy Time Information" anchor="freebusy_example">      <t>        In this example, Cyrus requests the busy time information        of Wilfredo, Bernard and Mike.      </t>      <figure>        <preamble>&gt;&gt; Request &lt;&lt;</preamble>        <artwork><![CDATA[POST /home/cyrus/calendars/outbox/ HTTP/1.1Host: cal.example.comContent-Type: text/calendar; charset="utf-8"Content-Length: xxxxBEGIN:VCALENDARVERSION:2.0PRODID:-//Example Corp.//CalDAV Client//ENMETHOD:REQUESTBEGIN:VFREEBUSYUID:4FD3AD926350DTSTAMP:20090602T190420ZDTSTART:20090602T000000ZDTEND:20090604T000000ZORGANIZER;CN="Cyrus Daboo":mailto:cyrus@example.comATTENDEE;CN="Wilfredo Sanchez Vega":mailto:wilfredo@example.comATTENDEE;CN="Bernard Desruisseaux":mailto:bernard@example.netATTENDEE;CN="Mike Douglass":mailto:mike@example.orgEND:VFREEBUSYEND:VCALENDAR]]></artwork></figure>      <figure>        <preamble>&gt;&gt; Response &lt;&lt;</preamble>        <artwork><![CDATA[HTTP/1.1 200 OKDate: Tue, 02 Jun 2009 20:07:34 GMTContent-Type: application/xml; charset="utf-8"Content-Length: xxxx<?xml version="1.0" encoding="utf-8" ?><C:schedule-response xmlns:D="DAV:"       xmlns:C="urn:ietf:params:xml:ns:caldav"><C:response><C:recipient><D:href>mailto:wilfredo@example.com</D:href></C:recipient><C:request-status>2.0;Success</C:request-status><C:calendar-data>BEGIN:VCALENDARVERSION:2.0PRODID:-//Example Corp.//CalDAV Server//ENMETHOD:REPLYBEGIN:VFREEBUSYUID:4FD3AD926350DTSTAMP:20090602T200733ZDTSTART:20090602T000000ZDTEND:20090604T000000ZORGANIZER;CN="Cyrus Daboo":mailto:cyrus@example.comATTENDEE;CN="Wilfredo Sanchez Vega":mailto:wilfredo@example.comFREEBUSY;FBTYPE=BUSY:20090602T110000Z/20090602T120000ZFREEBUSY;FBTYPE=BUSY:20090603T170000Z/20090603T180000ZEND:VFREEBUSYEND:VCALENDAR</C:calendar-data></C:response><C:response><C:recipient><D:href>mailto:bernard@example.net</D:href></C:recipient><C:request-status>2.0;Success</C:request-status><C:calendar-data>BEGIN:VCALENDARVERSION:2.0PRODID:-//Example Corp.//CalDAV Server//ENMETHOD:REPLYBEGIN:VFREEBUSYUID:4FD3AD926350DTSTAMP:20090602T200733ZDTSTART:20090602T000000ZDTEND:20090604T000000ZORGANIZER;CN="Cyrus Daboo":mailto:cyrus@example.comATTENDEE;CN="Bernard Desruisseaux":mailto:bernard@example.netFREEBUSY;FBTYPE=BUSY:20090602T150000Z/20090602T160000ZFREEBUSY;FBTYPE=BUSY:20090603T090000Z/20090603T100000ZFREEBUSY;FBTYPE=BUSY:20090603T180000Z/20090603T190000ZEND:VFREEBUSYEND:VCALENDAR</C:calendar-data></C:response><C:response><C:recipient><D:href>mailto:mike@example.org</D:href></C:recipient><C:request-status>3.7;Invalid calendar user</C:request-status></C:response></C:schedule-response>]]></artwork></figure>    </section>    <section title="Example: User Attempting to Invite Attendee on behalf of Organizer">      <t>        In the following example, Cyrus attempts to create,        on behalf of Wilfredo, an event with Bernard specified        as an Attendee. The request fails since Wilfredo didn't        grant Cyrus the right to invite other calendar users        on his behalf.      </t>      <figure>        <preamble>&gt;&gt; Request &lt;&lt;</preamble>        <artwork><![CDATA[PUT /home/wilfredo/calendars/work/def456.ics HTTP/1.1Host: cal.example.comContent-Type: text/calendar; charset="utf-8"Content-Length: xxxxIf-None-Match: *BEGIN:VCALENDARVERSION:2.0PRODID:-//Example Corp.//CalDAV Client//ENBEGIN:VEVENTUID:3504F926D3ADSEQUENCE:0DTSTAMP:20090602T190221ZDTSTART:20090602T230000ZDTEND:20090603T000000ZTRANSP:OPAQUESUMMARY:DinnerORGANIZER;CN="Wilfredo Sanchez Vega":mailto:wilfredo@example.comATTENDEE;CN="Wilfredo Sanchez Vega";CUTYPE=INDIVIDUAL;PARTSTAT=A CCEPTED:mailto:wilfredo@example.comATTENDEE;CN="Bernard Desruisseaux";CUTYPE=INDIVIDUAL;PARTSTAT=NE EDS-ACTION;ROLE=REQ-PARTICIPANT;RSVP=TRUE:mailto:bernard@exampl e.netEND:VEVENTEND:VCALENDAR]]></artwork></figure>      <figure>        <preamble>&gt;&gt; Response &lt;&lt;</preamble>        <artwork><![CDATA[HTTP/1.1 403 ForbiddenContent-Type: application/xml; charset="utf-8"Content-Length: xxxx<?xml version="1.0" encoding="utf-8" ?><D:error xmlns:D="DAV:" xmlns:C="urn:ietf:params:xml:ns:caldav">  <D:need-privileges>    <D:resource>      <D:href>/home/wilfredo/calendars/outbox/</D:href>      <D:privilege><C:schedule-send-invite/></D:privilege>    </D:resource>  </D:need-privileges></D:error>]]></artwork></figure>    </section>    <section title="Example: Attendee Declining an Instance of a Recurring Event">      <t>        In the following example, Bernard declines the second recurrence        instance of a daily recurring event he's been invited to by Cyrus.      </t>      <figure>        <preamble>&gt;&gt; Request &lt;&lt;</preamble>        <artwork><![CDATA[PUT /home/bernard/calendars/work/4FD3AD926350.ics HTTP/1.1Host: cal.example.comContent-Type: text/calendar; charset="utf-8"Content-Length: xxxxIf-Schedule-Tag-Match: "7775FB30-7534-489E-A79A-0EA147B933EB"BEGIN:VCALENDARVERSION:2.0PRODID:-//Example Corp.//CalDAV Client//ENBEGIN:VTIMEZONETZID:America/MontrealBEGIN:STANDARDDTSTART:20071104T020000RRULE:FREQ=YEARLY;BYMONTH=11;BYDAY=1SUTZNAME:ESTTZOFFSETFROM:-0400TZOFFSETTO:-0500END:STANDARDBEGIN:DAYLIGHTDTSTART:20070311T020000RRULE:FREQ=YEARLY;BYMONTH=3;BYDAY=2SUTZNAME:EDTTZOFFSETFROM:-0500TZOFFSETTO:-0400END:DAYLIGHTEND:VTIMEZONEBEGIN:VEVENTUID:9263504FD3ADSEQUENCE:0DTSTAMP:20090602T185254ZDTSTART;TZID=America/Montreal:20090601T150000DTEND;TZID=America/Montreal:20090601T160000RRULE:FREQ=DAILY;INTERVAL=1;COUNT=5TRANSP:OPAQUESUMMARY:Review Internet-DraftORGANIZER;CN="Cyrus Daboo":mailto:cyrus@example.comATTENDEE;CN="Cyrus Daboo";CUTYPE=INDIVIDUAL;PARTSTAT=ACCEPTED: mailto:cyrus@example.comATTENDEE;CN="Bernard Desruisseaux";CUTYPE=INDIVIDUAL;PARTSTAT= ACCEPTED;ROLE=REQ-PARTICIPANT;RSVP=TRUE:mailto:bernard@exampl e.netEND:VEVENTBEGIN:VEVENTUID:9263504FD3ADSEQUENCE:0DTSTAMP:20090603T183823ZRECURRENCE-ID;TZID=America/Montreal:20090602T150000DTSTART;TZID=America/Montreal:20090602T150000DTEND;TZID=America/Montreal:20090602T160000TRANSP:TRANSPARENTSUMMARY:Review Internet-DraftORGANIZER;CN="Cyrus Daboo":mailto:cyrus@example.comATTENDEE;CN="Cyrus Daboo";CUTYPE=INDIVIDUAL;PARTSTAT=ACCEPTED: mailto:cyrus@example.comATTENDEE;CN="Bernard Desruisseaux";CUTYPE=INDIVIDUAL;PARTSTAT= DECLINED;ROLE=REQ-PARTICIPANT;RSVP=TRUE:mailto:bernard@exampl e.netEND:VEVENTEND:VCALENDAR]]></artwork></figure>      <figure>        <preamble>&gt;&gt; Response &lt;&lt;</preamble>        <artwork><![CDATA[HTTP/1.1 200 OKContent-Length: 0Date: Tue, 02 Jun 2009 18:52:54 GMTLast-Modified: Tue, 02 Jun 2009 18:52:54 GMTETag: "d85561cfe74a4e785eb4639451b434fb"Schedule-Tag: "488177c8-2ea7-4176-a6cb-fab8cfccdea2"]]></artwork></figure>      <t>        Bernard's participation status update will cause his        server to deliver a scheduling message to Cyrus.        Cyrus's client will find the following reply message        from Bernard in Cyrus's scheduling Inbox collection:      </t>      <figure>        <preamble>&gt;&gt; Request &lt;&lt;</preamble>        <artwork><![CDATA[GET /home/cyrus/calendars/inbox/9263504FD3AD.ics HTTP/1.1Host: cal.example.com]]></artwork></figure>      <figure>        <preamble>&gt;&gt; Response &lt;&lt;</preamble>        <artwork><![CDATA[HTTP/1.1 200 OKDate: Tue, 02 Jun 2009 18:52:58 GMTLast-Modified: Tue, 02 Jun 2009 18:52:58 GMTETag: "eb897deabc8939589da116714bc99265"Content-Type: text/calendar; charset="utf-8"Content-Length: xxxxBEGIN:VCALENDARVERSION:2.0PRODID:-//Example Corp.//CalDAV Client//ENMETHOD:REPLYBEGIN:VTIMEZONETZID:America/MontrealBEGIN:STANDARDDTSTART:20071104T020000RRULE:FREQ=YEARLY;BYMONTH=11;BYDAY=1SUTZNAME:ESTTZOFFSETFROM:-0400TZOFFSETTO:-0500END:STANDARDBEGIN:DAYLIGHTDTSTART:20070311T020000RRULE:FREQ=YEARLY;BYMONTH=3;BYDAY=2SUTZNAME:EDTTZOFFSETFROM:-0500TZOFFSETTO:-0400END:DAYLIGHTEND:VTIMEZONEBEGIN:VEVENTUID:9263504FD3ADSEQUENCE:0DTSTAMP:20090603T183823ZRECURRENCE-ID;TZID=America/Montreal:20090602T150000DTSTART;TZID=America/Montreal:20090602T150000DTEND;TZID=America/Montreal:20090602T160000SUMMARY:Review Internet-DraftORGANIZER;CN="Cyrus Daboo":mailto:cyrus@example.comATTENDEE;CN="Bernard Desruisseaux";PARTSTAT=DECLINED: mailto:bernard@example.netREQUEST-STATUS:2.0;SuccessEND:VEVENTEND:VCALENDAR]]></artwork></figure>    </section>    <section title="Example: Attendee Removing an Instance of a Recurring Event">      <t>        In the following example, Bernard removes from his calendar the        third recurrence instance of a daily recurring event he's been        invited to by Cyrus. This is accomplished by the addition of an "EXDATE" property to the scheduling object resource stored by Bernard.      </t>      <figure>        <preamble>&gt;&gt; Request &lt;&lt;</preamble>        <artwork><![CDATA[PUT /home/bernard/calendars/work/4FD3AD926350.ics HTTP/1.1Host: cal.example.comContent-Type: text/calendar; charset="utf-8"Content-Length: xxxxIf-Schedule-Tag-Match: "488177c8-2ea7-4176-a6cb-fab8cfccdea2"BEGIN:VCALENDARVERSION:2.0PRODID:-//Example Corp.//CalDAV Client//ENBEGIN:VTIMEZONETZID:America/MontrealBEGIN:STANDARDDTSTART:20071104T020000RRULE:FREQ=YEARLY;BYMONTH=11;BYDAY=1SUTZNAME:ESTTZOFFSETFROM:-0400TZOFFSETTO:-0500END:STANDARDBEGIN:DAYLIGHTDTSTART:20070311T020000RRULE:FREQ=YEARLY;BYMONTH=3;BYDAY=2SUTZNAME:EDTTZOFFSETFROM:-0500TZOFFSETTO:-0400END:DAYLIGHTEND:VTIMEZONEBEGIN:VEVENTUID:9263504FD3ADSEQUENCE:0DTSTAMP:20090602T185254ZDTSTART;TZID=America/Montreal:20090601T150000DTEND;TZID=America/Montreal:20090601T160000RRULE:FREQ=DAILY;INTERVAL=1;COUNT=5EXDATE;TZID=America/Montreal:20090603T150000TRANSP:OPAQUESUMMARY:Review Internet-DraftORGANIZER;CN="Cyrus Daboo":mailto:cyrus@example.comATTENDEE;CN="Cyrus Daboo";CUTYPE=INDIVIDUAL;PARTSTAT=ACCEPTED: mailto:cyrus@example.comATTENDEE;CN="Bernard Desruisseaux";CUTYPE=INDIVIDUAL;PARTSTAT= ACCEPTED;ROLE=REQ-PARTICIPANT;RSVP=TRUE:mailto:bernard@exampl e.netEND:VEVENTBEGIN:VEVENTUID:9263504FD3ADSEQUENCE:0DTSTAMP:20090603T183823ZRECURRENCE-ID;TZID=America/Montreal:20090602T150000DTSTART;TZID=America/Montreal:20090602T150000DTEND;TZID=America/Montreal:20090602T160000TRANSP:TRANSPARENTSUMMARY:Review Internet-DraftORGANIZER;CN="Cyrus Daboo":mailto:cyrus@example.comATTENDEE;CN="Cyrus Daboo";CUTYPE=INDIVIDUAL;PARTSTAT=ACCEPTED: mailto:cyrus@example.comATTENDEE;CN="Bernard Desruisseaux";CUTYPE=INDIVIDUAL;PARTSTAT= DECLINED;ROLE=REQ-PARTICIPANT;RSVP=TRUE:mailto:bernard@exampl e.netEND:VEVENTEND:VCALENDAR]]></artwork></figure>      <t>        Bernard's deletion of a recurrence instance will cause his        server to deliver a scheduling message to Cyrus.        Cyrus's client will find the following reply message        from Bernard in Cyrus's scheduling Inbox collection:      </t>      <figure>        <preamble>&gt;&gt; Request &lt;&lt;</preamble>        <artwork><![CDATA[GET /home/cyrus/calendars/inbox/6504923FD3AD.ics HTTP/1.1Host: cal.example.com]]></artwork></figure>      <figure>        <preamble>&gt;&gt; Response &lt;&lt;</preamble>        <artwork><![CDATA[HTTP/1.1 200 OKDate: Tue, 02 Jun 2009 18:52:58 GMTLast-Modified: Tue, 02 Jun 2009 18:52:58 GMTETag: "eb897deabc8939589da116714bc99265"Content-Type: text/calendar; charset="utf-8"Content-Length: xxxxBEGIN:VCALENDARVERSION:2.0PRODID:-//Example Corp.//CalDAV Client//ENMETHOD:REPLYBEGIN:VTIMEZONETZID:America/MontrealBEGIN:STANDARDDTSTART:20071104T020000RRULE:FREQ=YEARLY;BYMONTH=11;BYDAY=1SUTZNAME:ESTTZOFFSETFROM:-0400TZOFFSETTO:-0500END:STANDARDBEGIN:DAYLIGHTDTSTART:20070311T020000RRULE:FREQ=YEARLY;BYMONTH=3;BYDAY=2SUTZNAME:EDTTZOFFSETFROM:-0500TZOFFSETTO:-0400END:DAYLIGHTEND:VTIMEZONEBEGIN:VEVENTUID:9263504FD3ADSEQUENCE:0DTSTAMP:20090603T183823ZRECURRENCE-ID;TZID=America/Montreal:20090603T150000DTSTART;TZID=America/Montreal:20090603T150000DTEND;TZID=America/Montreal:20090603T160000SUMMARY:Review Internet-DraftORGANIZER;CN="Cyrus Daboo":mailto:cyrus@example.comATTENDEE;CN="Bernard Desruisseaux";PARTSTAT=DECLINED: mailto:bernard@example.netREQUEST-STATUS:2.0;SuccessEND:VEVENTEND:VCALENDAR]]></artwork></figure>    </section>  </section>  <section title="Changes (to be removed by RFC Editor prior to publication)">    <section title="Changes in -12">    <t>      <list style="letters">        <t>          AppDir: More reworking of various sections for clarity.        </t>        <t>          AppDir: Removed terminology items defined in other specs.        </t>        <t>          AppDir: Now updates 5546.        </t>        <t>          AppDir: MAY instead of can in 3.2.10.1/2.        </t>        <t>          Fixed inconsistent whitespace in examples.        </t>        <t>        	IESG: added x-name and iana-token references in ABNF.        </t>        <t>        	IESG: clarified that allowed attendee changes are in addition to other pre-conditions.        </t>        <t>        	IESG: added privacy statement to address potential "leakage" of private data via scheduling messages or error responses.        </t>        <t>        	IESG: scrubbed through some RFC2119 language to avoid unnecessary use and repetition.        </t>       </list>    </t>    </section>    <section title="Changes in -11">    <t>      <list style="letters">        <t>          Major editorial changes to remove "cruft" that built up over time, to reduce repetitive statements, and to improve clarity.        </t>        <t>          SecDir: Added "Preventing Denial of Service Attacks" security sub-section.        </t>        <t>          SecDir: Added reference to RFC6125 and clarified how clients and server authenticate each other.        </t>        <t>          SecDir: Added "Mitigation of iTIP Threats" security sub-section.        </t>        <t>          SecDir: Added new text to privacy sub-section.        </t>        <t>          Fixed some XML examples.        </t>       </list>    </t>    </section>      <section title="Changes in -10">    <t>      <list style="letters">        <t>          Updated to RFC 6047 reference.        </t>        <t>          Various minor clarifications to behavior and terminology done.        </t>        <t>          Clarified that Inbox/Outbox are the server's responsibility to create.        </t>        <t>          Changed MAY to SHOULD for server rejecting organizer PARTSTAT changes of attendees.        </t>        <t>          Allow COMPLETED as a valid attendee change.        </t>        <t>          Allow SCHEDULE-STATUS as a valid attendee change on SCHEDULE-AGENT=CLIENT attendee properties.        </t>        <t>          COPY or MOVE on a calendar collection now declared to be undefined.        </t>        <t>          Changed precondition error codes from 409 to 403.        </t>        <t>          Clarified that rules 5546 must be used when server processes incoming scheduling messages.        </t>        <t>          default-calendar-delete-allowed -> default-calendar-needed.        </t>        <t>          Clarified that SCHEDULE-AGENT must be the same on all matching properties.        </t>        <t>          Added more text justifying the need for calendar-user-type property.        </t>       </list>    </t>    </section>  <section title="Changes in -09">    <t>      <list style="letters">        <t>          Fixed some examples.        </t>        <t>          Tweaked XML conventions.        </t>        <t>          Removed description in SCHEDULE-STATUS example values.        </t>        <t>          Tweaked 3.7 and 3.8 SCHEDULE-STATUS description to indicate it applies to the Organizer as well as Attendee.        </t>        <t>          Updated to RFC 5545 reference.        </t>        <t>            AD Review: clarified text about inbox resource deletion being acknowledgment of change.        </t>        <t>            AD Review: clarified description of freebusy Outbox POST.        </t>        <t>            AD Review: registered new 1.xx request-status codes and added new restriction on usage as per iTIP.        </t>        <t>            AD Review: changes SHOULD NOT to MUST NOT for new property parameters when clients send scheduling messages.        </t>        <t>            AD Review: CALDAV:schedule-calendar-transp now preserved during COPY.        </t>        <t>            AD Review: changed CALDAV- to CALDAV: in acl descriptions.        </t>        <t>            AD Review: fixed various minor typos.        </t>        <t>            AD Review: Added text to new principal properties to indicate that if they are not present, then the user is not enabled for the various scheduling operations.        </t>        <t>            AD Review: clarified use of CALDAV:calendar-data element in CALDAV:response element.        </t>        <t>            AD Review: made reference to 5545 IANA registry procedures for the two new element registries.        </t>        <t>            AD Review: Fixed description of B5. example.        </t>        <t>            Fixed SCHEDULE-AGENT/SCHEDULE-STATUS behavior for Attendee replies.        </t>       </list>    </t>    </section>    <section title="Changes in -08">    <t>      <list style="letters">        <t>          Added "Updates 4791".        </t>        <t>          XML conventions changed to match that in CardDAV spec.        </t>        <t>          Reworded child response behavior for Outbox.        </t>        <t>          Reworded "octet size".        </t>        <t>          If-Schedule-Match descriptions changed to remove implication that it is purely a conditional operation.        </t>        <t>          Schedule-Reply header descriptions generalized to resource removal rather than just HTTP DELETE.        </t>        <t>          Fixed various examples.        </t>       </list>    </t>    </section>    <section title="Changes in -07">    <t>      <list style="letters">        <t>          Restructured document.        </t>        <t>          Clarified that CALDAV:schedule-calendar-transp only          applies to calendar collection.        </t>        <t>          Removed CALDAV:schedule-state property on scheduling          messages in the scheduling Inbox collection.        </t>        <t>          Added conditional requests on scheduling object resources.        </t>        <t>          Added section on handling of PARTSTAT.        </t>        <t>          Added SCHEDULE-FORCE-SEND iCalendar property parameter.        </t>        <t>          Added clarification on child resources in scheduling Outbox          collections.        </t>        <t>          Clarified Attendee changes that server MUST allow, and          removed restrictions on changes that Attendee MUST NOT do.        </t>        <t>          Added Example Scheduling Transactions appendix.        </t>        <t>          Scheduling privileges are no longer required to be          non-abstract.        </t>        <t>          Removed handling of REFRESH requests.        </t>        <t>          Removed handling of VJOURNAL components.        </t>        <t>          Completed IANA Considerations section.        </t>        <t>          Added references to RFC3283 and RFC5234.        </t>        <t>          Updated references to iCalendar, iTIP and iMIP.        </t>      </list>    </t>    </section>    <section title="Changes in -06">      <t>        <list style="letters">          <t>            Removed distinction between scheduling calendar collections            and basic calendar collections - now just have calendar            collections.          </t>          <t>            Clients now "MAY" reload data rather than "SHOULD" reload            data.          </t>          <t>            Fixed &lt;C:recipient&gt; in examples.          </t>          <t>            Removed CALDAV:attachments-allowed precondition on POST to            Outbox as that is no longer relevant.          </t>          <t>            Added CALDAV:default-calendar-delete-allowed precondition            for DELETE.          </t>          <t>            Relaxed MUST->MAY for Organizer setting PARTSTAT value.          </t>          <t>            Tweaked restrictions on Create/Modify to emphasize that 4791            restrictions also apply.          </t>          <t>            Added comment that 'opaque' is the default when the            CALDAV:schedule-calendar-transp property is not present.          </t>          <t>            Description of Schedule-Reply header changed to reflect that            it is only relevant for Attendees.          </t>          <t>            Minor typos fixed.          </t>        </list>      </t>    </section>    <section title="Changes in -05">      <t>        This draft has changed substantially since the -04 version. The        primary reason for this change was implementation experience from        a number of vendors who implemented products based on the earlier        drafts. Experience showed that the client/server interaction was        not reliable in keeping scheduling messages synchronized between        organizer and attendees. In addition the latency in updates due        to clients being offline proved unacceptable to users. These        issues led to the redesign of this specification to support a        server-based processing model that eliminates all the problems        seen previously. Whilst this adds significant complexity to the        server in that it needs to be a full blown iTIP processing agent,        it does remove a lot of the same complexity from clients, opening        up the possibility of supporting complex scheduling behaviors        even with "thin" clients.      </t>      <t>        In the judgement of the authors, we consider this new specification        to be a substantial improvement over the old one and believe        it represents a stronger protocol that will lead to better        interoperability.      </t>    </section>  </section></back></rfc>