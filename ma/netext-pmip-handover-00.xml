<?xml version="1.0" encoding="US-ASCII"?>
<!-- This template is for creating an Internet Draft using xml2rfc,
     which is available here: http://xml.resource.org. -->
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!-- One method to get references from the online citation libraries.
     There has to be one entity for each item to be referenced. 
     An alternate method (rfc include) is described in the references. -->

<!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC5213 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5213.xml">
<!ENTITY RFC2473 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2473.xml">
<!ENTITY RFC3168 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3168.xml">
<!ENTITY RFC3315 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3315.xml">
<!ENTITY RFC3775 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3775.xml">
<!ENTITY RFC4282 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4282.xml">
<!ENTITY RFC4283 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4283.xml">
<!ENTITY RFC4291 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4291.xml">
<!ENTITY RFC4301 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4301.xml">
<!ENTITY RFC4303 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4303.xml">
<!ENTITY RFC4861 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4861.xml">


<!ENTITY RFC1981 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.1981.xml">
<!ENTITY RFC2865 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2865.xml">
<!ENTITY RFC3588 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3588.xml">
<!ENTITY RFC3963 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3963.xml">
<!ENTITY RFC3971 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3971.xml">
<!ENTITY RFC4140 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4140.xml">
<!ENTITY RFC4306 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4306.xml">
<!ENTITY RFC4330 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4330.xml">
<!ENTITY RFC4372 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4372.xml">
<!ENTITY RFC4821 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4821.xml">
<!ENTITY RFC4830 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4830.xml">
<!ENTITY RFC4831 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4831.xml">
<!ENTITY I-D.narten-iana-considerations-rfc2434bis SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.narten-iana-considerations-rfc2434bis.xml">
]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<!-- used by XSLT processors -->
<!-- For a complete list and description of processing instructions (PIs), 
     please see http://xml.resource.org/authoring/README.html. -->
<!-- Below are generally applicable Processing Instructions (PIs) that most I-Ds might want to use.
     (Here they are set differently than their defaults in xml2rfc v1.32) -->
<?rfc strict="yes" ?>
<!-- give errors regarding ID-nits and DTD validation -->
<!-- control the table of contents (ToC) -->
<?rfc toc="yes"?>
<!-- generate a ToC -->
<?rfc tocdepth="4"?>
<!-- the number of levels of subsections in ToC. default: 3 -->
<!-- control references -->
<?rfc symrefs="yes"?>
<!-- use symbolic references tags, i.e, [RFC2119] instead of [1] -->
<?rfc sortrefs="yes" ?>
<!-- sort the reference entries alphabetically -->
<!-- control vertical white space 
     (using these PIs as follows is recommended by the RFC Editor) -->
<?rfc compact="yes" ?>
<!-- do not start each main section on a new page -->
<?rfc subcompact="no" ?>
<!-- keep one blank line between list items -->
<!-- end of list of popular I-D processing instructions -->
<rfc category="info" docName="draft-ma-netext-pmip-handover-00.txt" ipr="trust200902">
  <!-- category values: std, bcp, info, exp, and historic
     ipr values:full2026, noDerivativeWorks2026,  none full3667, noModification3667, noDerivatives3667, full3978, noModification3978, noDerivatives3978,  
trust200811,noModificationTrust200811, noDerivativesTrust200811, trust200902, noModificationTrust200902, noDerivativesTrust200902, pre5378Trust200902
you can add the attributes updates="NNNN" and obsoletes="NNNN" 
     they will automatically be output with "(if approved)"  -->

  <!-- ***** FRONT MATTER ***** -->

  <front>
    <!-- The abbreviated title is used in the page header - it is only necessary if the 
         full title is longer than 39 characters -->

    <title abbrev="Abbreviated Title">Network-based Inter-domain handover Support for Proxy Mobile IPv6</title>

    <!-- add 'role="editor"' below for the editors if appropriate -->

    <!-- Another author who claims to be an editor -->

    <author fullname="Zhengming Ma "  
            surname="Ma">
      <organization>SUN YAT-SEN UNIVERSITY</organization>

      <address>
        <postal>
 
          <street>Department of Electronics and Engineering,daxuecheng,313</street>

          <!-- Reorder these if your country does things differently -->

          <city>Zhongshan University,Guangzhou</city>

         <region></region>

          <code>510006</code>

          <country> P.R. China</country>
        </postal>

       

        <email>issmzm@mail.sysu.edu.cn </email>

        <!-- uri and facsimile elements may also be added -->
      </address>
    </author>
<author fullname="Ke Wang"  
            surname="Wang">
      <organization>SUN YAT-SEN UNIVERSITY</organization>

      <address>
        <postal>
       
          <street>Department of Electronics and Engineering,daxuecheng,313</street>

          <!-- Reorder these if your country does things differently -->

          <city>Zhongshan University,Guangzhou</city>

             <region></region>

          <code>510006</code>

          <country>P.R. China</country>
        </postal>

         <email>wang923zheng@sina.com </email>

        <!-- uri and facsimile elements may also be added -->
      </address>
    </author>
<author fullname="Fei Zhang"  
            surname="Zhang">
      <organization>SUN YAT-SEN UNIVERSITY</organization>

      <address>
        <postal>
       
          <street>Department of Electronics and Engineering,daxuecheng,313</street>

          <!-- Reorder these if your country does things differently -->

          <city>Zhongshan University,Guangzhou</city>

             <region></region>

          <code>510006</code>

          <country>P.R. China</country>
        </postal>

        <email>zsu05zhangfei@163.com </email>

        <!-- uri and facsimile elements may also be added -->
      </address>
    </author>
    <date month="October" year="2011" />

    <!-- If the month and year are both specified and are the current ones, xml2rfc will fill 
         in the current day for you. If only the current year is specified, xml2rfc will fill 
	 in the current day and month for you. If the year is not the current one, it is 
	 necessary to specify at least a month (xml2rfc assumes day="1" if not specified for the 
	 purpose of calculating the expiry date).  With drafts it is normally sufficient to 
	 specify just the year. -->

    <!-- Meta-data Declarations -->

    <area>General</area>

    <workgroup>Network Working Group</workgroup>

    <!-- WG name at the upperleft corner of the doc,
         IETF is fine for individual submissions.  
	 If this element is not present, the default is "Network Working Group",
         which is used by the RFC Editor as a nod to the history of the IETF. -->

    <keyword>template</keyword>

    <!-- Keywords will be incorporated into HTML output
         files in a meta tag but they have no effect on text or nroff
         output. If you submit your draft to the RFC Editor, the
         keywords will be used for the search engine. -->

    <abstract>

	<t>[RFC5380] prompts the Inner-domain handover of the MN in Proxy Mobile  IPv6(PMIPv6).This document describes network-based Inter-domain handover functionality and corresponding mobility options for PMIPv6.This document strictly abides by the two principle describes in PMIPv6:</t>
	<t>(a)The movement of MN is transparent to CN.</t>
	<t>(b)MN doesn't participate in any mobility-related signaling.LMA and MAG are responsible for managing IP mobility on behalf of the host.</t>
<t>The points of this document are as follows:</t>
<t>(1) Concepts: The MN's Home Agent(HA) ,Home Address (HoA) and Care-of address(CoA) is not only for user but also for the specific session.MN initiating a session uses the address assigned by the LMA which the MN is registered at the moment as the HoA for the session.The user initiating a session uses the address assigned by the LMA which the MN moves to as the CoA for the session.</t>
<t>(2) Binding Cache:Every local mobility anchor must maintain two Binding Cache entries for each currently registered mobile node.  One is Inner-domain BCE,the other is Inter-domain BCE.  Inner-domain BCE maintains the binding between MN's Proxy-CoA and MN's HoA.  Inter-domain BCE maintains the bingding between CN's HoA and CN's CoA.</t>
<t>(3)Communication:For the user initiating a session or accepting a session,no
matter how it moves,the HoA for the session is unchanged,the source address of the data packets is the user's own HoA,and the destination address of the the data packets is the HoA of CN.All the reverse tunneled packets that the local mobility anchor received from the mobile access gateway, after removing the tunnel header MUST be routed to the destination specified in the inner packet header.  According to looking up the Inter-domain BCE,LMA gets the CoA of CN.  Then ,LMA encapsulates the packets to route to CN.On receiving a packet from a correspondent node with the destination address matching a mobile node's home network prefix(es), the local  mobility anchor MUST first remove the outer header before forwarding the packet.  Then,LMA looks up the Inner-domain BCE to forward the packets to the right MAG.</t>
<t>(4)Updates:When MN moves to visited LMA(MN-vLMA),MN-vLMA will do three things.</t>
<t>Firstly MN-vLMA will assign a MN-CoA for MN and build up the Inner-domain BCE for MN. Secondly,MN-vLMA will sends message to MN-hLMA to get the HoA of CN .Then,MN-vLMA builds up the binding between CN-HoA and CN-HoA in the Inter-domain BCE.Thirdly, MN-vLMA sends message to CN-LMA wiht the MN-CoA and MN-HoA included in the message to help CN-LMA updating the Inter-domain BCE for MN.  </t>

    </abstract>
  </front>

  <middle>
    <section title="Introduction">
      <t>Proxy Mobile IPv6 (PMIPv6) [RFC5213] is network based mobility management protocol which allows IP mobility session continuity for a Mobile Node (MN) without its involvement in mobility management signaling. In RFC5213 the inter-domain handover is not involved.This document describes the network-based Inter-domain handover options, and the corresponding functionality for Inter-domain handover for PMIPv6.  The Inter-domain handover takes place during MN moves from home LMA(hLMA) to visited LMA(vLMA).</t>
    <t> The network-based Inter-domain handover functionality described in this specification does not depend on information provisioned to external entities, such as the Domain Name System (DNS) or the Authentication,Authorization and Accounting (AAA) infrastructure.  The trust relationship and coordination management between LMAs within a PMIPv6 domain is deployment specific and will be described in this specification.</t>

    </section>

   <section title="Requirements and Terminology">
<section title="Requirements">
<t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT","SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in [RFC2119].</t>
 </section>
<section title="Terminology">
<t>In addition to the terminology defined in [RFC5213], the following terminology is also used:</t>
   <t>hLMA</t>
     <t>Home Local Mobility Anchor is the first LMA the MN registered and is the home agent for the mobile node in a Proxy Mobile IPv6 domain. It is the topological anchor point for the mobile node's home network prefix(es) and is the entity that manages the mobile node's binding state. The local mobility anchor has the functional capabilities of a home agent as defined  in Mobile IPv6 base specification [RFC3775] with the additional  capabilities required for supporting Proxy Mobile IPv6 protocol as defined in this specification.</t>
   <t>vLMA</t>
     <t> The vLMA is the LMA the MN visited.</t>
<t>rPBU</t>
     <t> A request message sent by a mobile access gateway to a mobile node's local mobility anchor for establishing a binding between the mobile node's home network prefix(es) assigned to a given interface of a mobile node and its current care-of address (Proxy-CoA).</t>
  <t> rPBA</t>
  <t>A reply message sent by a local mobility anchor in response to a Proxy Binding Update message that it received from a mobile access gateway.</t>
  <t> pPBU</t>
     <t> A request message sent from a LMA to another LMA. There are two kinds of message formats:a message sent from vLMA to hLMA and a message sent from vLMA to CN's LMA.</t>
  <t> pPBA</t>
    <t>  A reply message sent from a LMA to another LMA. There are two kinds of message formats:a message sent from hLMA to vLMA and a message sent from CN's LMA to vLMA.</t>
 <t>Home AAA (hAAA):</t>
     <t> An Authentication, Authorization, and Accounting (AAA) server located in MN's home network.  In scope of this document the hAAA corresponds to a RADIUS server that includes the role of the PMIPv6 Policy Store.</t>
  <t> Visited AAA (vAAA):</t>
     <t> An Authentication, Authorization, and Accounting (AAA) server located in MN's visited network.  In this document the vAAA is the AAA server that acts as a RADIUS Proxy when the MN moves or attaches through the Visited network.  The VAAA receives an authentication (or accounting) request from an AAA client such as a NAS, forwards the request to the hAAA server, receives the reply from the hAAA, and sends that reply back to the AAA client potentially adding changes to reflect local administrative policy.</t>
 </section>
 </section>
<section title="The assumptions on the PMIPv6 domain">
<t>They are discussed here as they have an impact on PMIPv6 deployment.</t>
<t>Home AAA server records the user's static and dynamic information,and the dynamic information includes the information of LMA which the MN is registered right now.</t>
<t>The MN's Home Address (HoA) and Care-of address(CoA) is not only for user but also for the specific session.</t>
<t>MN initiating a session uses the address assigned by the LMA which the MN is registered as the HoA for the session.The user initiating a session uses the address assigned by the LMA which the MN moves to as the CoA for the session.</t>
<t>CN accepting a session uses the address assigned by the LMA which the CN is registered as the HoA for the session.CN accepting a session uses the address assigned by the LMA which the CN moves to as the CoA for the session.</t>
<t>For the user  initiating a session or accepting a session,no matter how it moves,the HoA for the session is unchanged,while the CoA for the session is changing.Then, the source address of the data packets sent by a user initiating a session or accepting a session is the user's own HoA,and the destination address of the the data packets is the HoA of the other end of the session.</t>
<t>The network-based Inter-domain handover Management not only ensures the continuity in the session but also ensures that the MN will not detect any change with respect to CN.</t>
<t>This specification diverses the PBU/PBA message into two kinds of message formate: pPBU/pPBA message between LMAs ,rPBU/rPBA message between LMA and MAG.</t>
 </section>
<section title="Local Mobility Anchor Operation">
<t>The local mobility anchor MUST support the home agent function as defined in [RFC3775] and the extensions defined in this
   specification.  A home agent with these modifications and enhanced capabilities for supporting the Proxy Mobile IPv6 protocol is
   referred to as a local mobility anchor.This section describes the operational details of the local mobility anchor.</t>
<section title="Home address configuration">
<t>LMA not only assignes the network prefix of the home address for the new users , but also configures the home address for the new users.So that LMA can performs mobility management on behalf of a mobile node.</t>
</section>
<section title="Binding Cache Entry Data in LMA">
<t>Every local mobility anchor MUST maintain two Binding Cache entries for each currently registered mobile node. One is Inner-domain BCE,the other is Inter-domain BCE. Inner-domain BCE maintains the binding between MN's Proxy-CoA and MN's HoA.
Inter-domain BCE maintains the bingding between CN's HoA and CN's CoA.</t>
</section>
<section title=" Forwarding Considerations">
<t>LMA should  intercepts the packets sent to the Mobile Node's Home Network:When the local mobility anchor is serving a mobile node, it MUST be able to receive packets that are sent to the mobile node's home network.  In order for it to receive those packets, it MUST advertise a connected route in to the Routing Infrastructure for the mobile node's home network prefix(es) or for an aggregated prefix with a larger scope.  This essentially enables IPv6 routers in that network to detect the local mobility anchor as the last-hop router for the mobile node's home network prefix(es).</t>

<section title=" Forwarding Packets Sent by the Mobile Node">
<t>All the reverse tunneled packets that the local mobility anchor received from the mobile access gateway, after removing the tunnel header MUST be routed to the destination specified in the inner packet header. According to looking up the Inter-domain BCE,LMA gets the CoA of CN. Then ,LMA encapsulates the packets to route to CN. The format of the tunneled packet is shown below:</t>
                        <t> IPv6 header (src= LMAA, dst= CN's CoA)  /* Tunnel Header */</t>
                         <t>IPv6 header (src= MN's HoA, dst= CN's HoA )  /* Packet Header */</t>
                                <t> Upper layer protocols             /* Packet Content*/</t>
                              
</section>
<section title=" Forwarding Packets to the Mobile Node:">
<t>On receiving a packet from a correspondent node with the destination address matching a mobile node's home network  prefix(es), the local mobility anchor MUST first remove the outer header before forwarding the packet. Then,LMA looks up the Inner-domain BCE to forward the packets to the right MAG.The format of the tunneled packet is shown below:</t>
                      <t>IPv6 header (src= LMAA, dst= MN's Proxy CoA)  /* Tunnel Header */</t>
                        <t> IPv6 header (src= CN's HoA, dst= MN's HoA )  /* Packet Header */</t>
                                <t> Upper layer protocols             /* Packet Content*/</t>
                              
</section>
</section>
</section>

<section title=" Mobile Access Gateway Operation">
<t>RFC5213 introduces a new functional entity, the mobile access gateway (MAG).The mobile access gateway is the entity that is responsible for detecting the mobile node's movements to and from the access link and sending the Proxy Binding Update messages to the local mobility anchor. In essence, the mobile access gateway performs mobility management on behalf of a mobile node.</t>
  <t> Every mobile access gateway MUST maintain a Binding Update List.Each entry in the Binding Update List represents a mobile node's mobility binding with its local mobility anchor. The Binding Update List is a conceptual data structure.</t>
  <t> For supporting this specification, the conceptual Binding Update List entry data structure needs be extended as follows:</t>
  <t> (a)After detecting a new mobile node on its access link, the mobile access gateway MUST identify the mobile node and acquire its   MN-Identifier. If it determines that the network-based mobility management service needs to be offered to the mobile node, it
 MUST send a Proxy Binding Update message to the local mobility anchor.</t>
<t>(b)If the MAG detectes the MN's registration is initial binding registration , the MAG will maintain a binding between MN's HoA and hLMA  when it recieves the rPBA message.</t>
<t>(c)If the MAG detectes the MN is performing a inter-domain handover , the MAG will maintain a binding between MN's HoA ,vLMA and CoA when it recieves the rPBA message from vLMA. The CoA which is included in rPBA message is the address vLMA assigns for MN.</t>
</section>


<section title=" Protocol Operation">
<t>In order to improve the performance during inter-handover (when operations such as attachment to a new LMA and signaling between LMAs are involved), the PFMIPv6 protocol in this document specifies new message forms between the MN's hLMA and MN's vLMA and new message forms between the MN's vLMA and CN's LMA.  In this specification take the communication between MN and CN as a example. Both MN and CN are in PMIPv6 domain.</t>
<section title=" Initial Binding Registration and Forwarding Considerations">
<t>Both MN and CN are in PMIPv6 domain.The related signaling of Initial Binding Registration is described in RFC5213. Both MN and CN has registered in its hLMA ,and both gets its home address (MN-HoA and CN-HoA).The reference network is illustrated in Figure 1.</t>
 <figure align="center">
    
        <artwork align="left"><![CDATA[
   
   +---------+         +----------+
   | MN-hLMA |---------| CN-hLMA  |
   +---------+         +----------+
       |                    |   
       |                    |
   +---------+         +----------+
   | MN-MAG  |         | CN-MAG   |
   +---------+         +----------+
       |                    |   
       |                    |
   +---------+         +----------+
   |    MN   |         |   CN     |
   +---------+         +----------+

            ]]></artwork>

        <postamble>Figure 1:Reference network for Initial Binding Registration and Forwarding Considerations
		</postamble>
      </figure>
	<t>Forwarding Considerations:</t>
	<t>(a) Packets from MN to CN: </t>
	<t>(1).The source address is MN-HoA, and the destination address is CN-HoA.</t>
	<t>(2).The packets are forwarded from MN to MN-MAG through Link-layer.</t>
	<t>(3).The packets are forwarded form MN-MAG to MN-hLMA through tunnel, the source address of the tunnel is MN-MAG's IP address (MN-Proxy-CoA), and the destination address of the tunnel is MN-hLMA's address (MN-hLMAA).</t>
	<t>(4).MN-hLMA encapsulates the packets to route to CN. The format of the tunneled packet is shown below:</t>
                         <t>IPv6 header (src= MN-hLMAA, dst= CN's HoA)  /* Tunnel Header */</t>
                         <t>IPv6 header (src= MN's HoA, dst= CN's HoA )  /* Packet Header */</t>
	                                <t> Upper layer protocols        /* Packet Content*/</t>
<t>(5)The packets are intercepted by CN-hLMA.CN-hLMA encapsulates the packets and forwards them to CN-MAG  through tunnel, the source address of the tunnel is CN-hLMA's address (CN-hLMAA), and the destination address of the tunnel is CN-MAG's address (CN-Proxy-CoA).</t>
<t>(6)CN-MAG encapsulates the packets and forwards them to CN through Link-layer.</t>
<t>(b) Packets from CN to MN: </t>
	<t>(1).The source address is CN-HoA , and the destination address is MN-HoA .</t>
	<t>(2).The packets are forwarded from CN to CN-MAG through Link-layer.</t>
	<t>(3).The packets are forwarded form CN-MAG to CN-hLMA through tunnel, the source address of the tunnel is CN-Proxy-CoA and the destination address of the tunnel is CN-hLMAA.</t>
	<t>(4).CN-hLMA encapsulates the packets to route to MN. The format of the tunneled packet is shown below:</t>
                        <t> IPv6 header (src= CN-hLMAA, dst= MN's HoA)  /* Tunnel Header */</t>
                         <t>IPv6 header (src= CN's HoA, dst= MN's HoA )  /* Packet Header */</t>
                        <t>Upper layer protocols             /* Packet Content*/</t>
	<t>(5). The packets are intercepted by MN-hLMA.MN-hLMA encapsulates the packets and forwards them to MN-MAG through tunnel, the source address of the tunnel is MN-hLMAA, and the destination address of the tunnel is MN-Proxy-CoA.</t>
	<t>(6).MN-MAG encapsulates the packets and forwards them to MN through Link-layer.</t>
</section>
<section title=" MN Performs Inter-domain handover">
<t>On the basis of situation described in 6.1,MN roams to MN-vLMA domain and CN is still in its home domain.The reference network is illustrated in Figure 2.</t>
 <figure align="center">
    
        <artwork align="left"><![CDATA[
   
       +------------------------------------------+
       |                                          |
   +---------+     +---------+               +----------+
   | MN-vLMA |-----| MN-hLMA |               | CN-hLMA  |
   +---------+     +---------+               +----------+      
       |                                          |   
       |                                          |
   +---------+                               +----------+
   | MN-MAG2  |                              | CN-MAG   |
   +---------+                               +----------+
       |                                          |   
       |                                          |
   +---------+                               +----------+
   |    MN   |                               |   CN     |
   +---------+                               +----------+

            ]]></artwork>

        <postamble>Figure 2:MN roams to MN- vLMA domain
		</postamble>
      </figure>
<section title=" Inter-domain handover operation">
 <t>In RFC5213 the inter-domain handover is not involved.This document describes the network-based Inter-domain handover options, and the corresponding functionality for Inter-domain handover for PMIPv6.Since the MN is not involved in IP mobility signaling in PMIPv6, the sequence of events illustrating the MN inter-domain handover are shown in Figure 3.</t>
<figure align="center">
    
        <artwork align="left"><![CDATA[
   
      
           +-------+   RADIUS   +-------+
           |MN-hAAA|<---------->|MN-vAAA|
           +-------+            +-------+
                                    |RADIUS
                                    |
       +--+ +------+ +-------+ +-------+  +-------+ +-------+ 
       |MN| |MN-MAG| |MN-hLMA| |MN-MAG2|  |MN-vLMA| |CN-hLMA|  
       +--+ +------+ +-------+ +-------+  +-------+ +-------+ 
        |      |          |       |          |         |         
        |      |DeReg PBU |       |          |         |         
        |      |------- ->|       |          |         |
        |      | rPBA     |       |          |         |         
        |      |<---------|       |          |         |         
        |      |   RS     |       |          |         |         
        |------------------------>|          |         |      
        |      |          |       |          |         |         
        |      |          |       |    rPBU  |         |         
        |      |          |       |---------->         |         
        |      |          |       |    rPBA  |         |         
        |      |          |       <----------|         |            
        |      |          |       |   pPBU   |         |          
        |      |          <------------------|         |          
        |      |          |       |   pPBA   |         |                
        |      |          |----------------->|         |         
        |      |          |       |          |   pPBU| |
        |      |          |       |          |--------->
        |      |          |       |          |   pPBA  |         
        |      |    RA    |       |          |<--------|         
        |<------------------------|          |         |        
        |      |          |       |          |         |        



   ]]></artwork>

        <postamble>Figure 3:signaling of MN inter-handover
		</postamble>
      </figure>
 <t>(a)MN-MAG detects that a handover is imminent and sends the DeReg PBU message to the MN-hLMA asking MN-hLMA to remove the binding between MN-MAG and MN.</t>
  <t> (b)The MN-hLMA sends back the rPBA message to MN-MAG.</t>
  <t> (c) MN roams to MN-vLMA, and sends Router Solicit(RS) message to MN-MAG2. The MN-HoA and CN-HoA are included in RS message.</t>
  <t> (d) Upon receiving RS message ,MN-MAG2 sends request to download the per MN Policy Profile from the MN-vAAA.</t>
  <t> (e)MN-vAAA assigns a MN-vLMA to MN -MAG2 ,and sends request to MN-hAAA to download the per MN Policy Profile . MN-vLMA's address is included in the request message.</t>
  <t>(f)MN-hAAA receives the request message and sends the MN Policy Profile to MN-vAAA ,then MN-hAAA uses MN-vLMAA to take place of MN-hLMAA.</t>
 <t>(g)MN-vAAA sends the Accept Message which includes both MN-hLMAA and MN-vLMAA to MN-MAG2.</t>
 <t>(h) MN-MAG2 sends the rPBU message to MN-vLMA. MN-HoA,CN-HoA and MN-hLMAA are included in rPBU message .</t>
 <t>(i) Upon receiving rPBU message, MN-vLMA firstly assigns a MN-CoA for MN ,builds up the inner-domain BCE for MN and sends rPBA message back to MN-MAG2 .The MN-CoA is included in rPBA message.In the Inner-domain BCE there is a  binding between MN's Proxy-CoA2 and MN's CoA. </t>
<t>Secondly,MN-vLMA sends pPBU message to MN-hLMA,the source address of the pPBU message is MN-vLMAA and the destination address of the pPBU message is MN-hLMAA. CN-HoA is included in pPBU message. Upon receiving the pPBU message,MN-hLMA sends back pPBA message to MN- vLMA with CN-HoA included .MN-vLMA builds up the binding between CN-HoA and CN-HoA in the Inter-domain BCE.</t>
<t>Thirdly,MN-vLMA sends pPBU message to CN-hLMA, the source address of the pPBU message is MN-CoA and the destination address of the pPBU message is CN-HoA.The pPBU message includes the MN-CoA and MN-HoA. This pPBU message is packaged in UDP format,and by judging the format of the message CN-hLMA  intercepts the pPBU message ,encapsulates the message and updates the Inter-domain BCE for MN. That means in the Inter-domain BCE there is a binding between MN-CoA and MN-HoA.</t>

<t>(j) After receiving rPBA message from MN-vLMA, MN-MAG2 builds up the binding among MN-HoA ,MN-CoA and MN-vLMA.
 Then MN-MAG2 sends Router Advertise (RA) message to MN. The inter-domain handover operation is over.</t>
</section>
<section title=" Forwarding Consideratons">

<t>Forwarding Considerations:</t>

<t>(a) Packets from MN to CN: </t>

<t>(1).The source address is MN-HoA, and the destination address is CN-HoA.</t>

<t>(2).The packets are forwarded from MN to MN-MAG2 through Link-layer.</t>

<t>(3).The packets are forwarded form MN-MAG2 to MN-hLMA through tunnel, the source address of the tunnel is MN-MAG2's IP address, and the destination address of the tunnel is MN-vLMAA.</t>

<t>(4).MN-vLMA encapsulates the packets to route to CN. The format of the tunneled packet is shown below:</t>
                        
<t> IPv6 header (src= MN-vLMAA, dst= CN's HoA)  /* Tunnel Header */</t>
                         
<t>IPv6 header (src= MN's HoA, dst= CN's HoA )  /* Packet Header */</t>
                                 
<t>Upper layer protocols             /* Packet Content*/</t>
   
<t>(5).The packets are intercepted by CN-hLMA.CN-hLMA encapsulates the packets and forwards them to CN-MAG  through tunnel, the source address of the tunnel is CN-hLMAA, and the destination address of the tunnel is CN-Proxy-CoA . </t>
   
<t>(6).CN-MAG encapsulates the packets and forwards them to CN through Link-layer.</t>

<t>(b) Packets from CN to MN: </t>

<t>(1).The source address is CN-HoA , and the destination address is MN-HoA .</t>

<t>(2).The packets are forwarded from CN to CN-MAG through Link-layer.</t>

<t>(3).The packets are forwarded form CN-MAG to CN-hLMA through tunnel, the source address of the tunnel is CN-Proxy-CoA and the destination address of the tunnel is CN-hLMAA.</t>

<t>(4).CN-hLMA encapsulates the packets to route to MN. The format of the tunneled packet is shown below:</t>
                        
<t> IPv6 header (src= CN-hLMAA, dst= MN's CoA)  /* Tunnel Header */</t>
                         
<t>IPv6 header (src= CN's HoA, dst= MN's HoA )  /* Packet Header */</t>
                             
<t> Upper layer protocols             /* Packet Content*/</t>

<t>(5). The packets are intercepted by MN-vLMA.MN-vLMA encapsulates the packets and forwards them to MN-MAG2 through tunnel, the source address of the tunnel is MN-vLMAA, and the destination address of the tunnel is MN-Proxy-CoA2.</t>

<t>(6).MN-MAG2 encapsulates the packets and forwards them to MN through Link-layer.</t>

</section>
</section>
<section title=" CN Performs Inter-domain handover">
<t>On the basis of situation described in 6.2,CN roams to CN-vLMA domain and MN is still in MN-vLMA domain.The reference network is illustrated in Figure 4.</t>
 <figure align="center">
    
        <artwork align="left"><![CDATA[
   
       +--------------------------------------------+
       |                                            |
   +---------+   +---------+   +----------+   +----------+ 
   | MN-vLMA |---| MN-hLMA |   | CN-hLMA  |---| CN-vLMA  |
   +---------+   +---------+   +----------+   +----------+  
       |                                           |   
       |                                           |
   +---------+                                +----------+
   | MN-MAG2 |                                | CN-MAG2  |
   +---------+                                +----------+
       |                                           |   
       |                                           |
   +---------+                                +----------+
   |    MN   |                                |   CN     |
   +---------+                                +----------+

            ]]></artwork>

        <postamble>Figure 4:CN roams to CN- vLMA domain
		</postamble>
      </figure>
<section title=" Inter-domain handover operation">
<t>The sequence of events illustrating the CN inter-domain handover are shown in Figure 5.</t>
<figure align="center">
    
        <artwork align="left"><![CDATA[
   
      
      
           +-------+   RADIUS   +-------+
           |CN-hAAA|<---------->|CN-vAAA|
           +-------+            +-------+
                                    |RADIUS
                                    |
       +--+ +------+ +-------+ +-------+  +-------+ +-------+ 
       |CN| |CN-MAG| |CN-hLMA| |CN-MAG2|  |CN-vLMA| |MN-vLMA|  
       +--+ +------+ +-------+ +-------+  +-------+ +-------+ 
        |      |          |       |          |         |         
        |      |DeReg PBU |       |          |         |                
        |      |------- ->|       |          |         |    
        |      | rPBA     |       |          |         |         
        |      |<---------|       |          |         |         
        |      |   RS     |       |          |         |         
        |------------------------>|          |         |         
        |      |          |       |          |         |         
        |      |          |       |          |         |         
        |      |          |       |          |         |         
        |      |          |       |    rPBU  |         |         
        |      |          |       |---------->         |         
        |      |          |       |    rPBA  |         |         
        |      |          |       <----------|         |      
        |      |          |       |   pPBU   |         |          
        |      |          <------------------|         |          
        |      |          |       |   pPBA   |         |          
        |      |          |----------------->|         |         
        |      |          |       |          |   pPBU| |
        |      |          |       |          |--------->
        |      |          |       |          |   pPBA  |         
        |      |    RA    |       |          |<--------|         
        |<------------------------|          |         |        
        |      |          |       |          |         |            








   ]]></artwork>

        <postamble>Figure 5:signaling of CN inter-handover
		</postamble>
      </figure>
<t>(a)CN-MAG detects that a handover is imminent and sends the DeReg PBU message to the CN-hLMA asking CN-hLMA to remove the binding between CN-MAG and CN.</t>
   <t>(b)The CN-hLMA sends back the rPBA message to CN-MAG.</t>
   <t>(c) CN roams to CN-vLMA, and sends RS message to CN-MAG2. The CN-HoA and MN-HoA are included in RS message.</t>
   <t>(d) Upon receiving RS message ,CN-MAG2 sends request to download the per CN Policy Profile from the CN-vAAA.</t>
  <t>(e)CN-vAAA assigns a CN-vLMA to CN -MAG2 ,and sends request to CN-hAAA to download the per CN Policy Profile . CN-vLMA's address is included in the request message.</t>
  <t>(f)CN-hAAA receives the request message and sends the CN Policy Profile to CN-vAAA ,then CN-hAAA uses CN-vLMAA to take place of CN-hLMAA.</t>
 <t>(g)CN-vAAA sends the Accept Message which includes both CN-hLMAA and CN-vLMAA to CN-MAG2.</t>
 <t>(h) CN-MAG2 sends the rPBU message to CN-vLMA. MN-HoA,CN-HoA and CN-hLMAA are included in rPBU message .</t>
 <t>(i) Upon receiving rPBU message, CN-vLMA firstly assigns a CN-CoA for CN ,builds up the inner-domain BCE for CN and sends rPBA message back to CN-MAG2 .The CN-CoA is included in rPBA message.In the Inner-domain BCE there is a binding between CN's Proxy-CoA2 and CN's CoA. </t>
<t>Secondly,CN-vLMA sends pPBU message to CN-hLMA,the source address of the pPBU message is CN-vLMAA and the destination address of the pPBU message is CN-hLMAA. MN-HoA is included in pPBU message. Upon receiving the pPBU message,CN-hLMA sends back pPBA message to CN-vLMA with MN-HoA and MN-CoA included .CN-vLMA updates the inter-domain BCE with the binding between MN-HoA and MN-CoA.</t>
<t>Thirdly,CN-vLMA sends pPBU message to MN-hLMA, the source address of the pPBU message is CN-CoA and the destination address of the pPBU message is MN-CoA.The pPBU message includes the CN-CoA and CN-HoA. This pPBU message is packaged in UDP format,and by judging the format of the message MN-hLMA  intercepts the pPBU message ,encapsulates the message and updates the Inter-domain BCE for CN. That means in the Inter-domain BCE there is a binding between CN-CoA and CN-HoA.</t>
<t>(j) After receiving rPBA message from CN-vLMA, CN-MAG2 builds up the binding among CN-HoA ,CN-CoA and CN-vLMA.
 Then CN-MAG2 sends RA message to CN. The inter-domain handover operation is over.</t>
</section>
<section title="Forwarding Consideratons">
<t>Forwarding Considerations:</t>
<t>(a) Packets from MN to CN: </t>
<t>(1).The source address is MN-HoA, and the destination address is CN-HoA.</t>
<t>(2).The packets are forwarded from MN to MN-MAG2 through Link-layer.</t>
<t>(3).The packets are forwarded form MN-MAG2 to MN-hLMA through tunnel, the source address of the tunnel is MN-MAG2's IP address, and the destination address of the tunnel is MN-vLMAA.</t>
<t>(4).MN-vLMA encapsulates the packets to route to CN. The format of the tunneled packet is shown below:</t>
                         <t>IPv6 header (src= MN-vLMAA, dst= CN's CoA)  /* Tunnel Header */</t>
                         <t>IPv6 header (src= MN's HoA, dst= CN's HoA )  /* Packet Header */</t>
                                 <t>Upper layer protocols             /* Packet Content*/</t>
  <t>(5).The packets are intercepted by CN-vLMA.CN-vLMA encapsulates the packets and forwards them to CN-MAG2  through tunnel, the source address of the tunnel is CN-vLMAA, and the destination address of the tunnel is CN-Proxy-CoA2 . </t>
  <t>(6).CN-MAG2 encapsulates the packets and forwards them to CN through Link-layer.</t>
<t>(b) Packets from CN to MN: </t>
<t>(1).The source address is CN-HoA , and the destination address is MN-HoA .</t>
<t>(2).The packets are forwarded from CN to CN-MAG2 through Link-layer.</t>
<t>(3).The packets are forwarded form CN-MAG2 to CN-vLMA through tunnel, the source address of the tunnel is CN-Proxy-CoA2 and the destination address of the tunnel is CN-vLMAA.</t>
<t>(4).CN-vLMA encapsulates the packets to route to MN. The format of the tunneled packet is shown below:</t>
                         <t>IPv6 header (src= CN-vLMAA, dst= MN's CoA)  /* Tunnel Header */</t>
                         <t>IPv6 header (src= CN's HoA, dst= MN's HoA )  /* Packet Header */</t>
                             <t> Upper layer protocols             /* Packet Content*/</t>
<t>(5). The packets are intercepted by MN-vLMA.MN-vLMA encapsulates the packets and forwards them to MN-MAG2 through tunnel, the source address of the tunnel is MN-vLMAA, and the destination address of the tunnel is MN-Proxy-CoA2.</t>
<t>(6).MN-MAG2 encapsulates the packets and forwards them to MN through Link-layer.</t>
</section>
</section>
</section>
<section title="Message Formats">
<t>This section defines extensions to the Proxy Mobile IPv6 [RFC5213] protocol messages.</t>
<section title="rPBU">
<figure align="center" >
    
        <artwork align="left"><![CDATA[
    0               1               2               3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                   |            Sequence #         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |A|H|L|K|M|R|P|D|  Reserved     |            Lifetime           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         MN-Identifier                         |
   |                         MN-hLMAA                              |
   |                         CN-HoA                                |               
   |                         MN-HoA                                |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       

            ]]></artwork>

        <postamble> Figure 6:rPBU 
		</postamble>
      </figure>

<t>A Binding Update message that is sent by a mobile access gateway to a local mobility anchor is referred to as the "rPBU" message.A new flag (D) is included in the rPBU message. The rest of the Binding Update message format remains the same as defined in [RFC5213] and with the additional (R) and (M) flags, as specified in [RFC3963] and [RFC4140], respectively. </t>
<t>Distinguish Flag (D)</t>
<t>A new flag (D) is included in the Binding Update message to indicate to the local mobility anchor that the Binding Update
 message is a proxy registration sent by a mobile access gateway to a local mobility anchor. The flag MUST be set to the
 value of 1 .</t>
<t>The rPBU message sent by a mobile access gateway to a local mobility anchorcontains MN-Identifer , MN-hLMAA, MN-HoA and CN-HoA.</t>

</section>

<section title="rPBA">
<figure align="center" >
    
        <artwork align="left"><![CDATA[
    0               1               2               3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                   |    Status     |K|R|P|D|Reserved| 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        Sequence #             |            Lifetime           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         MN's IP address                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


            ]]></artwork>

        <postamble> Figure 7:rPBA 
		</postamble>
      </figure>
<t>A Binding Acknowledgement message that is sent by a local mobility anchor to a mobile access gateway is referred to as the "rPBA" message. A new flag (D) is included in the Binding Acknowledgement message. The rest of the Binding Acknowledgement message format remains the same as defined in [RFC5213] and with the additional (R) flag as specified in [RFC3963].</t>
<t>Distinguish Registration Flag (D)</t>
<t>A new flag (D) is included in the Binding Acknowledgement message to indicate that the local mobility anchor processed the
 corresponding Proxy Binding Update message as rPBU message. The flag is set to a value of 1 .
The rPBA message sent by a local mobility anchor to a mobile access gateway contains MN's IP address assigned by the local mobility anchor .</t>

</section>

<section title="pPBU">
<figure align="center" >
    
        <artwork align="left"><![CDATA[
    0               1               2               3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                   |            Sequence #         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |A|H|L|K|M|R|P|D|  Reserved     |            Lifetime           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                   options                                     |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

            ]]></artwork>

        <postamble> Figure 8:pPBU 
		</postamble>
      </figure>
<t>A Binding Update message that is sent by a local mobility anchor to a local mobility anchor is referred to as the "pPBU" message.A new flag (D) and a new flag (M) are included in the pPBU message. The rest of the Binding Update message format remains the same as defined in [RFC5213] and with the additional (R) and (M) flags, as specified in [RFC3963] and [RFC4140], respectively. </t>
<t>Distinguish Flag (D)</t>
<t>A new flag (D) is included in the Binding Update message to indicate to the local mobility anchor that the Binding Update
 message is a proxy registration sent by a local mobility anchor to a local mobility anchor. The flag MUST be set to the
 value of 2 or 3.</t>
<figure align="center" >
    
        <artwork align="left"><![CDATA[
    0               1               2               3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                   |            Sequence #         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |A|H|L|K|M|R|P|D|  Reserved     |            Lifetime           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                   MN-HoA                                      |
   |                   CN-HoA                                      |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


            ]]></artwork>

        <postamble> Figure 9:pPBU sent by a visit LMA to the home LMA 
		</postamble>
      </figure>
<t>A new flag (D) is included in the Binding Update message to indicate to the local mobility anchor that the Binding Update
 message is a PBU message sent by a visit local mobility anchor to the home local mobility anchor. The flag MUST be set to the
 value of 2. This pPBU message sent by a visit local mobility anchor to the home local mobility anchor contains MN-HoA and CN-HoA.</t>
<figure align="center" >
    
        <artwork align="left"><![CDATA[
    0               1               2               3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                   |            Sequence #         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |A|H|L|K|M|R|P|D|  Reserved     |            Lifetime           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                   MN-HoA                                      |
   |                   MN-CoA                                      |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       

            ]]></artwork>

        <postamble> Figure 10:pPBU sent by MN's LMA to CN's LMA 
		</postamble>
      </figure>
<t>A new flag (D) is included in the Binding Update message to indicate to the local mobility anchor that the Binding Update
 message is a PBU message sent by MN's local mobility anchor to CN's local mobility anchor . The flag MUST be set to the
 value of 3.This pPBU message sent by MN's local mobility anchor to CN's local mobility anchor contains MN-HoA and MN-HoA.</t>

</section>


<section title="pPBA">
<figure align="center" >
    
        <artwork align="left"><![CDATA[
    0               1               2               3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                   |    Status     |K|R|P|D|Reserved| 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        Sequence #             |            Lifetime           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         options                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       

            ]]></artwork>

        <postamble> Figure 11:pPBA 
		</postamble>
      </figure>
<t>A Binding Acknowledgement message that is sent by a local mobility anchor to a local mobility anchor is referred to as the "pPBA" message. A new flag (D) and a new flag (M) are included in the Binding Acknowledgement message. The rest of the Binding Acknowledgement message format remains the same as defined in [RFC5213] and with the additional (R) flag as specified in [RFC3963].</t>
<t>Distinguish Registration Flag (D)	</t>
<t>A new flag (D) is included in the Binding Acknowledgement message to indicate that the local mobility anchor processed the
 corresponding Proxy Binding Update message as pPBU message. The flag is set to a value of 2 or 3.</t>
 <t>A new flag (D) is included in the Binding Acknowledgement message to indicate that the local mobility anchor processed the
 corresponding Proxy Binding Update message as pPBU message sent by a visit local mobility anchor to the home local mobility anchor.       The flag is set to a value of 2 .The options of the message contains the CN-CoA.</t>
 <t>A new flag (D) is included in the Binding Acknowledgement message to indicate that the local mobility anchor processed the
 corresponding Proxy Binding Update message as pPBU message sent by MN's local mobility anchor to CN's local mobility anchor.       The flag is set to a value of 3 .</t>

</section>


</section>





   

    <section title="Security Considerations">
     <t>The potential security threats against any network-based mobility management protocol are described in [RFC4832]. This section
 explains how Proxy Mobile IPv6 protocol defends itself against those threats. </t>
 <t>Proxy Mobile IPv6 protocol recommends the signaling messages, Proxy Binding Update and Proxy Binding Acknowledgement, exchanged between the mobile access gateway and the local mobility anchor or between a local mobility anchor and a local mobility anchorto be protected using IPsec using the established security associationbetween them. This essentially eliminates the threats related to the impersonation of the mobile access gateway or the local mobility anchor.</t>
<t>This specification allows a mobile access gateway to send binding registration messages on behalf of a mobile node. If proper
 authorization checks are not in place, a malicious node may be able to hijack a mobile node's mobility session or may carry out a denial-of-service attack. To prevent this attack, this specification requires the local mobility anchor to allow only authorized mobile
 access gateways that are part of that Proxy Mobile IPv6 domain to send Proxy Binding Update messages on behalf of a mobile node.</t>
 <t>To eliminate the threats on the interface between the mobile access gateway and the mobile node, this specification requires an
 established trust between the mobile access gateway and the mobile node and to authenticate and authorize the mobile node before it is
 allowed to access the network. Further, the established authentication mechanisms enabled on that access link will ensure
 that there is a secure binding between the mobile node's identity and its link-layer address. The mobile access gateway will definitively
 identify the mobile node from the packets that it receives on that access link.</t>
<t> To address the threat related to a compromised mobile access gateway, the local mobility anchor, before accepting a Proxy Binding Update message for a given mobile node, may ensure that the mobile node is attached to the mobile access gateway that sent the Proxy Binding Update message. This may be accomplished by contacting a trusted entity, which is able to track the mobile nodes current point of attachment. However, the specific details of the actual mechanisms for achieving this is outside the scope of this document. </t>

    </section>

    <section title="IANA Considerations">
      <t>This document defines six new Mobility Header options, the HomeNetwork Prefix Option, Handoff Indicator Option, Access Technology
 Type Option, Mobile Node Link-layer Identifier Option, Link-local Address Option, and Timestamp Option. The Type value for these options has been assigned from the same numbering space as allocated for the other mobility options,as defined in [RFC3775].

</t>
<t>The Handoff Indicator Option introduces a new Handoff Indicator (HI) numbering space, where the values from 0 to 5 have been reserved by this document. Approval of new Handoff Indicator type values are to be made through IANA Expert Review.
</t>
<t>The Access Technology Type Option introduces a new Access Technology type (ATT) numbering space, where the values from 0 to 5 have been reserved by this document. Approval of new Access Technology type values are to be made through IANA Expert Review.</t>
<t>This document also defines new Binding Acknowledgement status values. The status values MUST be assigned from the same number space used for Binding Acknowledgement status values,as defined in [RFC3775]. The allocated values for each of thesestatus values must be greater than 128. </t>
<t>This document creates a new registry for the flags in the Binding</t>
<t>Update message called the "Distinguish Flag".</t>
<t>The following flags are reserved:</t>
<t>(A) 0x8000 [RFC3775]</t>
<t>(H)0x4000 [RFC3775]</t>
<t> (L)0x2000 [RFC3775]</t>
<t> (K) 0x1000 [RFC3775]</t>
<t> (M) 0x0800 [RFC4140]</t>
<t>(R) 0x0400 [RFC3963]</t>
<t>(P) 0x0200[RFC5213]</t>
<t>This document reserves a new flag (D) as follows:</t>
<t>(D) 0x0100</t>
<t>The rest of the values in the 16-bit field are reserved. New values can be assigned by Standards Action or IESG approval.</t>
<t>This document also creates a new registry for the flags in the Binding Acknowledgment message called the "Distinguish Flag". The following values are reserved.</t>
<t>(K) 0x80 [RFC3775]</t>
<t>(R) 0x40 [RFC3963]</t>
<t>(P) 0x20 [RFC5213]</t>
<t> This document reserves a new flag (D) as follows:</t>
<t>(D) 0x10 </t>
    </section>
  


</middle>

  <!--  *****BACK MATTER ***** -->

  <back>
    <!-- References split into informative and normative -->

    <!-- There are 2 ways to insert reference entries from the citation libraries:
     1. define an ENTITY at the top, and use "ampersand character"RFC2629; here (as shown)
     2. simply use a PI "less than character"?rfc include="reference.RFC.2119.xml"?> here
        (for I-Ds: include="reference.I-D.narten-iana-considerations-rfc2434bis.xml")

     Both are cited textually in the same manner: by using xref elements.
     If you use the PI option, xml2rfc will, by default, try to find included files in the same
     directory as the including file. You can also define the XML_LIBRARY environment variable
     with a value containing a set of directories to search.  These can be either in the local
     filing system or remote ones accessed by http (http://domain/dir/... ).-->

    <references title="Normative References">
<!-- Here we use entities that we defined at the beginning. -->
     &RFC2119;
    &RFC5213;
 &RFC2473;
 &RFC3168;
 &RFC3315;
 &RFC3775;
&RFC4282;
&RFC4283;
 &RFC4291;
&RFC4301;
&RFC4303;
 &RFC4861;
      
    </references>



    <references title="Informative References">
      <!-- Here we use entities that we defined at the beginning. -->
&RFC1981;
&RFC2865;
&RFC3588;
&RFC3963;
&RFC3971;
&RFC4140;
&RFC4306;
&RFC4330;
&RFC4372;
&RFC4821;
&RFC4830;
&RFC4831;
   
    </references>

    
    <!-- Change Log

v00 2006-03-15  EBD   Initial version

v01 2006-04-03  EBD   Moved PI location back to position 1 -
                      v3.1 of XMLmind is better with them at this location.
v02 2007-03-07  AH    removed extraneous nested_list attribute,
                      other minor corrections
v03 2007-03-09  EBD   Added comments on null IANA sections and fixed heading capitalization.
                      Modified comments around figure to reflect non-implementation of
                      figure indent control.  Put in reference using anchor="DOMINATION".
                      Fixed up the date specification comments to reflect current truth.
v04 2007-03-09 AH     Major changes: shortened discussion of PIs,
                      added discussion of rfc include.
v05 2007-03-10 EBD    Added preamble to C program example to tell about ABNF and alternative 
                      images. Removed meta-characters from comments (causes problems).  -->
  </back>
</rfc>
